var b={IDLE:0,LOADED:2,ERROR:3,EMPTY:4},P={ANIMATING:0,INTERACTING:1},x={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function Bt(n,t,e){let i,s;return t<n[0]?i=n[0]-t:n[2]<t?i=t-n[2]:i=0,e<n[1]?s=n[1]-e:n[3]<e?s=e-n[3]:s=0,i*i+s*s}function Qe(n,t){return qt(n,t[0],t[1])}function Je(n,t){return n[0]<=t[0]&&t[2]<=n[2]&&n[1]<=t[1]&&t[3]<=n[3]}function qt(n,t,e){return n[0]<=t&&t<=n[2]&&n[1]<=e&&e<=n[3]}function Qt(n,t){const e=n[0],i=n[1],s=n[2],r=n[3],o=t[0],l=t[1];let a=x.UNKNOWN;return o<e?a=a|x.LEFT:o>s&&(a=a|x.RIGHT),l<i?a=a|x.BELOW:l>r&&(a=a|x.ABOVE),a===x.UNKNOWN&&(a=x.INTERSECTING),a}function Mt(){return[1/0,1/0,-1/0,-1/0]}function Et(n,t,e,i,s){return s?(s[0]=n,s[1]=t,s[2]=e,s[3]=i,s):[n,t,e,i]}function It(n){return Et(1/0,1/0,-1/0,-1/0,n)}function tn(n,t){const e=n[0],i=n[1];return Et(e,i,e,i,t)}function en(n,t,e,i,s){const r=It(s);return Jt(r,n,t,e,i)}function Jt(n,t,e,i,s){for(;e<i;e+=s)nn(n,t[e],t[e+1]);return n}function nn(n,t,e){n[0]=Math.min(n[0],t),n[1]=Math.min(n[1],e),n[2]=Math.max(n[2],t),n[3]=Math.max(n[3],e)}function sn(n,t){let e;return e=t(te(n)),e||(e=t(ee(n)),e)||(e=t(ie(n)),e)||(e=t(ne(n)),e)?e:!1}function te(n){return[n[0],n[1]]}function ee(n){return[n[2],n[1]]}function ot(n){return[(n[0]+n[2])/2,(n[1]+n[3])/2]}function rn(n,t,e,i,s){const[r,o,l,a,u,h,c,d]=on(n,t,e,i);return Et(Math.min(r,l,u,c),Math.min(o,a,h,d),Math.max(r,l,u,c),Math.max(o,a,h,d),s)}function on(n,t,e,i){const s=t*i[0]/2,r=t*i[1]/2,o=Math.cos(e),l=Math.sin(e),a=s*o,u=s*l,h=r*o,c=r*l,d=n[0],g=n[1];return[d-a+c,g-u-h,d-a-c,g-u+h,d+a-c,g+u+h,d+a+c,g+u-h,d-a+c,g-u-h]}function L(n){return n[3]-n[1]}function an(n,t,e){const i=e||Mt();return at(n,t)?(n[0]>t[0]?i[0]=n[0]:i[0]=t[0],n[1]>t[1]?i[1]=n[1]:i[1]=t[1],n[2]<t[2]?i[2]=n[2]:i[2]=t[2],n[3]<t[3]?i[3]=n[3]:i[3]=t[3]):It(i),i}function ne(n){return[n[0],n[3]]}function ie(n){return[n[2],n[3]]}function H(n){return n[2]-n[0]}function at(n,t){return n[0]<=t[2]&&n[2]>=t[0]&&n[1]<=t[3]&&n[3]>=t[1]}function $t(n){return n[2]<n[0]||n[3]<n[1]}function ln(n,t){return t?(t[0]=n[0],t[1]=n[1],t[2]=n[2],t[3]=n[3],t):n}function hn(n,t,e){let i=!1;const s=Qt(n,t),r=Qt(n,e);if(s===x.INTERSECTING||r===x.INTERSECTING)i=!0;else{const o=n[0],l=n[1],a=n[2],u=n[3],h=t[0],c=t[1],d=e[0],g=e[1],f=(g-c)/(d-h);let m,_;r&x.ABOVE&&!(s&x.ABOVE)&&(m=d-(g-u)/f,i=m>=o&&m<=a),!i&&r&x.RIGHT&&!(s&x.RIGHT)&&(_=g-(d-a)*f,i=_>=l&&_<=u),!i&&r&x.BELOW&&!(s&x.BELOW)&&(m=d-(g-l)/f,i=m>=o&&m<=a),!i&&r&x.LEFT&&!(s&x.LEFT)&&(_=g-(d-o)*f,i=_>=l&&_<=u)}return i}function un(...n){console.warn(...n)}function M(n,t,e){return Math.min(Math.max(n,t),e)}function cn(n,t,e,i,s,r){const o=s-e,l=r-i;if(o!==0||l!==0){const a=((n-e)*o+(t-i)*l)/(o*o+l*l);a>1?(e=s,i=r):a>0&&(e+=o*a,i+=l*a)}return j(n,t,e,i)}function j(n,t,e,i){const s=e-n,r=i-t;return s*s+r*r}function se(n){return n*180/Math.PI}function B(n){return n*Math.PI/180}function re(n,t){const e=n%t;return e*t<0?e+t:e}function dn(n,t,e){return n+e*(t-n)}function gn(n,t){const e=Math.pow(10,t);return Math.round(n*e)/e}function St(n,t,e){if(n>=t&&n<e)return n;const i=e-t;return((n-t)%i+i)%i+t}function fn(n,t){return n[0]+=+t[0],n[1]+=+t[1],n}function lt(n,t){let e=!0;for(let i=n.length-1;i>=0;--i)if(n[i]!=t[i]){e=!1;break}return e}function mn(n,t){const e=Math.cos(t),i=Math.sin(t),s=n[0]*e-n[1]*i,r=n[1]*e+n[0]*i;return n[0]=s,n[1]=r,n}const oe={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let pn=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||oe[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};var wt=pn;const q=6378137,z=Math.PI*q,_n=[-z,-z,z,z],Rn=[-180,-85,180,85],ht=q*Math.log(Math.tan(Math.PI/2));let X=class extends wt{constructor(t){super({code:t,units:"m",extent:_n,global:!0,worldExtent:Rn,getPointResolution:function(e,i){return e/Math.cosh(i[1]/q)}})}};const ae=[new X("EPSG:3857"),new X("EPSG:102100"),new X("EPSG:102113"),new X("EPSG:900913"),new X("http://www.opengis.net/def/crs/EPSG/0/3857"),new X("http://www.opengis.net/gml/srs/epsg.xml#3857")];function yn(n,t,e,i){const s=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(s));for(let r=0;r<s;r+=i){t[r]=z*n[r]/180;let o=q*Math.log(Math.tan(Math.PI*(+n[r+1]+90)/360));o>ht?o=ht:o<-ht&&(o=-ht),t[r+1]=o}return t}function Cn(n,t,e,i){const s=n.length;e=e>1?e:2,i=i??e,t===void 0&&(e>2?t=n.slice():t=new Array(s));for(let r=0;r<s;r+=i)t[r]=180*n[r]/z,t[r+1]=360*Math.atan(Math.exp(n[r+1]/q))/Math.PI-90;return t}const xn=6378137,le=[-180,-90,180,90],vn=Math.PI*xn/180;let F=class extends wt{constructor(t,e){super({code:t,units:"degrees",extent:le,axisOrientation:e,global:!0,metersPerUnit:vn,worldExtent:le})}};const he=[new F("CRS:84"),new F("EPSG:4326","neu"),new F("urn:ogc:def:crs:OGC:1.3:CRS84"),new F("urn:ogc:def:crs:OGC:2:84"),new F("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new F("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new F("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let Pt={};function Mn(n){return Pt[n]||Pt[n.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function En(n,t){Pt[n]=t}function ue(n){for(const t in n)delete n[t]}function In(n){let t;for(t in n)return!1;return!t}let V={};function Q(n,t,e){const i=n.getCode(),s=t.getCode();i in V||(V[i]={}),V[i][s]=e}function At(n,t){return n in V&&t in V[n]?V[n][t]:null}const ut=.9996,$=.00669438,ct=$*$,dt=ct*$,G=$/(1-$),ce=Math.sqrt(1-$),K=(1-ce)/(1+ce),de=K*K,Tt=de*K,Nt=Tt*K,ge=Nt*K,fe=1-$/4-3*ct/64-5*dt/256,$n=3*$/8+3*ct/32+45*dt/1024,Sn=15*ct/256+45*dt/1024,wn=35*dt/3072,Pn=3/2*K-27/32*Tt+269/512*ge,An=21/16*de-55/32*Nt,Tn=151/96*Tt-417/128*ge,Nn=1097/512*Nt,gt=6378137;function On(n,t,e){const i=n-5e5,s=(e.north?t:t-1e7)/ut/(gt*fe),r=s+Pn*Math.sin(2*s)+An*Math.sin(4*s)+Tn*Math.sin(6*s)+Nn*Math.sin(8*s),o=Math.sin(r),l=o*o,a=Math.cos(r),u=o/a,h=u*u,c=h*h,d=1-$*l,g=Math.sqrt(1-$*l),f=gt/g,m=(1-$)/d,_=G*a**2,y=_*_,p=i/(f*ut),I=p*p,v=I*p,E=v*p,w=E*p,st=w*p,rt=r-u/m*(I/2-E/24*(5+3*h+10*_-4*y-9*G))+st/720*(61+90*h+298*_+45*c-252*G-3*y);let A=(p-v/6*(1+2*h+_)+w/120*(5-2*_+28*h-3*y+8*G+24*c))/a;return A=St(A+B(_e(e.number)),-Math.PI,Math.PI),[se(A),se(rt)]}const me=-80,pe=84,bn=-180,Ln=180;function Fn(n,t,e){n=St(n,bn,Ln),t<me?t=me:t>pe&&(t=pe);const i=B(t),s=Math.sin(i),r=Math.cos(i),o=s/r,l=o*o,a=l*l,u=B(n),h=_e(e.number),c=B(h),d=gt/Math.sqrt(1-$*s**2),g=G*r**2,f=r*St(u-c,-Math.PI,Math.PI),m=f*f,_=m*f,y=_*f,p=y*f,I=p*f,v=gt*(fe*i-$n*Math.sin(2*i)+Sn*Math.sin(4*i)-wn*Math.sin(6*i)),E=ut*d*(f+_/6*(1-l+g)+p/120*(5-18*l+a+72*g-58*G))+5e5;let w=ut*(v+d*o*(m/2+y/24*(5-l+9*g+4*g**2)+I/720*(61-58*l+a+600*g-330*G)));return e.north||(w+=1e7),[E,w]}function _e(n){return(n-1)*6-180+3}const Gn=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function Re(n){let t=0;for(const s of Gn){const r=n.match(s);if(r){t=parseInt(r[1]);break}}if(!t)return null;let e=0,i=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(i=!0,e=t-32600),e?{number:e,north:i}:null}function ye(n,t){return function(e,i,s,r){const o=e.length;s=s>1?s:2,r=r??s,i||(s>2?i=e.slice():i=new Array(o));for(let l=0;l<o;l+=r){const a=e[l],u=e[l+1],h=n(a,u,t);i[l]=h[0],i[l+1]=h[1]}return i}}function Zn(n){return Re(n)?new wt({code:n,units:"m"}):null}function Dn(n){const t=Re(n.getCode());return t?{forward:ye(Fn,t),inverse:ye(On,t)}:null}const jn=[Dn],zn=[Zn];let Ot=!0;function Xn(n){Ot=!1}function Ce(n,t){if(t!==void 0){for(let e=0,i=n.length;e<i;++e)t[e]=n[e];t=t}else t=n.slice();return t}function bt(n){En(n.getCode(),n),Q(n,n,Ce)}function Vn(n){n.forEach(bt)}function J(n){if(typeof n!="string")return n;const t=Mn(n);if(t)return t;for(const e of zn){const i=e(n);if(i)return i}return null}function xe(n){Vn(n),n.forEach(function(t){n.forEach(function(e){t!==e&&Q(t,e,Ce)})})}function Kn(n,t,e,i){n.forEach(function(s){t.forEach(function(r){Q(s,r,e),Q(r,s,i)})})}function Lt(n,t){return n?typeof n=="string"?J(n):n:J(t)}function Un(n,t){const e=n.getCode(),i=t.getCode();let s=At(e,i);if(s)return s;let r=null,o=null;for(const a of jn)r||(r=a(n)),o||(o=a(t));if(!r&&!o)return null;const l="EPSG:4326";if(o)if(r)s=Ft(r.inverse,o.forward);else{const a=At(e,l);a&&(s=Ft(a,o.forward))}else{const a=At(l,i);a&&(s=Ft(r.inverse,a))}return s&&(bt(n),bt(t),Q(n,t,s)),s}function Ft(n,t){return function(e,i,s,r){return i=n(e,i,s,r),t(i,i,s,r)}}function ve(n,t){const e=J(n),i=J(t);return Un(e,i)}function Me(n,t){return n}function O(n,t){return Ot&&!lt(n,[0,0])&&n[0]>=-180&&n[0]<=180&&n[1]>=-90&&n[1]<=90&&(Ot=!1,un("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),n}function Yn(n,t){return n}function U(n,t){return n}function kn(){xe(ae),xe(he),Kn(he,ae,yn,Cn)}kn();function T(n,t){if(!n)throw new Error(t)}new Array(6);function ft(){return[1,0,0,1,0,0]}function N(n,t){const e=t[0],i=t[1];return t[0]=n[0]*e+n[2]*i+n[4],t[1]=n[1]*e+n[3]*i+n[5],t}function mt(n,t,e,i,s,r,o,l){const a=Math.sin(r),u=Math.cos(r);return n[0]=i*u,n[1]=s*a,n[2]=-i*a,n[3]=s*u,n[4]=o*i*u-l*i*a+t,n[5]=o*s*a+l*s*u+e,n}function Wn(n,t){const e=Hn(t);T(e!==0,"Transformation matrix cannot be inverted");const i=t[0],s=t[1],r=t[2],o=t[3],l=t[4],a=t[5];return n[0]=o/e,n[1]=-s/e,n[2]=-r/e,n[3]=i/e,n[4]=(r*a-o*l)/e,n[5]=-(i*a-s*l)/e,n}function Hn(n){return n[0]*n[3]-n[1]*n[2]}const Bn=[1e5,1e5,1e5,1e5,2,2];function qn(n){return"matrix("+n.join(", ")+")"}function Ee(n){return n.substring(7,n.length-1).split(",").map(parseFloat)}function Qn(n,t){const e=Ee(n),i=Ee(t);for(let s=0;s<6;++s)if(Math.round((e[s]-i[s])*Bn[s])!==0)return!1;return!0}function Jn(n,t){return n>t?1:n<t?-1:0}function Ie(n,t,e){if(n[0]<=t)return 0;const i=n.length;if(t<=n[i-1])return i-1;if(typeof e=="function"){for(let s=1;s<i;++s){const r=n[s];if(r===t)return s;if(r<t)return e(t,n[s-1],r)>0?s-1:s}return i-1}if(e>0){for(let s=1;s<i;++s)if(n[s]<t)return s-1;return i-1}if(e<0){for(let s=1;s<i;++s)if(n[s]<=t)return s;return i-1}for(let s=1;s<i;++s){if(n[s]==t)return s;if(n[s]<t)return n[s-1]-t<t-n[s]?s-1:s}return i-1}function ti(n,t){const e=Array.isArray(t)?t:[t],i=e.length;for(let s=0;s<i;s++)n[n.length]=e[s]}function $e(n,t){const e=n.length;if(e!==t.length)return!1;for(let i=0;i<e;i++)if(n[i]!==t[i])return!1;return!0}const Z=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",ei=Z.includes("safari")&&!Z.includes("chrom");ei&&(Z.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(Z)),Z.includes("webkit")&&Z.includes("edge"),Z.includes("macintosh");const ni=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope;(function(){let n=!1;try{const t=Object.defineProperty({},"passive",{get:function(){n=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return n})();function pt(n,t,e,i){let s;return ni?s=new OffscreenCanvas(n||300,t||300):s=document.createElement("canvas"),n&&(s.width=n),t&&(s.height=t),s.getContext("2d",i)}let Gt;function Se(){return Gt||(Gt=pt(1,1)),Gt}const ii=[NaN,NaN,NaN,0];let Zt;function si(){return Zt||(Zt=pt(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Zt}const ri=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,oi=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ai=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,li=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function _t(n,t){return n.endsWith("%")?Number(n.substring(0,n.length-1))/t:Number(n)}function tt(n){throw new Error('failed to parse "'+n+'" as color')}function we(n){if(n.toLowerCase().startsWith("rgb")){const r=n.match(oi)||n.match(ri)||n.match(ai);if(r){const o=r[4],l=100/255;return[M(_t(r[1],l)+.5|0,0,255),M(_t(r[2],l)+.5|0,0,255),M(_t(r[3],l)+.5|0,0,255),o!==void 0?M(_t(o,100),0,1):1]}tt(n)}if(n.startsWith("#")){if(li.test(n)){const r=n.substring(1),o=r.length<=4?1:2,l=[0,0,0,255];for(let a=0,u=r.length;a<u;a+=o){let h=parseInt(r.substring(a,a+o),16);o===1&&(h+=h<<4),l[a/o]=h}return l[3]=l[3]/255,l}tt(n)}const t=si();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=n,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=n,t.fillStyle===e&&tt(n));const i=t.fillStyle;if(i.startsWith("#")||i.startsWith("rgba"))return we(i);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const s=Array.from(t.getImageData(0,0,1,1).data);return s[3]=gn(s[3]/255,3),s}const hi=1024,et={};let Dt=0;function ui(n){if(n==="none")return ii;if(et.hasOwnProperty(n))return et[n];if(Dt>=hi){let e=0;for(const i in et)e++&3||(delete et[i],--Dt)}const t=we(n);t.length!==4&&tt(n);for(const e of t)isNaN(e)&&tt(n);return et[n]=t,++Dt,t}function Pe(n){return Array.isArray(n)?n:ui(n)}let ci=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var jt=ci;let di=class extends jt{constructor(t,e,i,s){super(t),this.inversePixelTransform=e,this.frameState=i,this.context=s}};var gi=di,nt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose"};let fi=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Se(),{get:(t,e)=>{if(typeof Se()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,i)=>(this.push_(e,i),!0)})}push_(...t){const e=this.instructions_,i=this.zIndex+this.offset_;e[i]||(e[i]=[]),e[i].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let i=0,s=e.length;i<s;++i){const r=e[i];if(typeof r=="function"){r(t);continue}const o=e[++i];if(typeof t[r]=="function")t[r](...o);else{if(typeof o=="function"){t[r]=o(t);continue}t[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}};var mi=fi,Rt={CHANGE:"change"};let pi=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};var _i=pi;function zt(){}function Ri(n){let t,e,i;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==i||!$e(s,e))&&(i=this,e=s,t=n.apply(this,arguments)),t}}let yi=class extends _i{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const i=this.listeners_||(this.listeners_={}),s=i[t]||(i[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",i=e?t:t.type,s=this.listeners_&&this.listeners_[i];if(!s)return;const r=e?new jt(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),l=this.pendingRemovals_||(this.pendingRemovals_={});i in o||(o[i]=0,l[i]=0),++o[i];let a;for(let u=0,h=s.length;u<h;++u)if("handleEvent"in s[u]?a=s[u].handleEvent(r):a=s[u].call(this,r),a===!1||r.propagationStopped){a=!1;break}if(--o[i]===0){let u=l[i];for(delete l[i];u--;)this.removeEventListener(i,zt);delete o[i]}return a}disposeInternal(){this.listeners_&&ue(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const i=this.listeners_[t];if(!i)return;const s=i.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(i[s]=zt,++this.pendingRemovals_[t]):(i.splice(s,1),i.length===0&&delete this.listeners_[t]))}};var Ci=yi;function Y(n,t,e,i,s){if(s){const o=e;e=function(l){return n.removeEventListener(t,e),o.call(i??this,l)}}else i&&i!==n&&(e=e.bind(i));const r={target:n,type:t,listener:e};return n.addEventListener(t,e),r}function Ae(n,t,e,i){return Y(n,t,e,i,!0)}function it(n){n&&n.target&&(n.target.removeEventListener(n.type,n.listener),ue(n))}let yt=class extends Ci{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(Rt.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const i=t.length,s=new Array(i);for(let r=0;r<i;++r)s[r]=Y(this,t[r],e);return s}return Y(this,t,e)}onceInternal(t,e){let i;if(Array.isArray(t)){const s=t.length;i=new Array(s);for(let r=0;r<s;++r)i[r]=Ae(this,t[r],e)}else i=Ae(this,t,e);return e.ol_key=i,i}unInternal(t,e){const i=e.ol_key;if(i)xi(i);else if(Array.isArray(t))for(let s=0,r=t.length;s<r;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}};yt.prototype.on,yt.prototype.once,yt.prototype.un;function xi(n){if(Array.isArray(n))for(let t=0,e=n.length;t<e;++t)it(n[t]);else it(n)}var Te=yt;function C(){throw new Error("Unimplemented abstract method.")}let vi=0;function Mi(n){return n.ol_uid||(n.ol_uid=String(++vi))}const Ei=5;let Ii=class extends Te{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=Ei}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return C()}getData(t){return null}prepareFrame(t){return C()}renderFrame(t,e){return C()}forEachFeatureAtCoordinate(t,e,i,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===b.LOADED||e.getState()===b.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=b.LOADED&&e!=b.ERROR&&t.addEventListener(Rt.CHANGE,this.boundHandleImageChange_),e==b.IDLE&&(t.load(),e=t.getState()),e==b.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}};var $i=Ii;let k=null;function Si(){k=pt(1,1,void 0,{willReadFrequently:!0})}let wi=class extends $i{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=ft(),this.pixelTransform=ft(),this.inversePixelTransform=ft(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,i){k||Si(),k.clearRect(0,0,1,1);let s;try{k.drawImage(t,e,i,1,1,0,0,1,1),s=k.getImageData(0,0,1,1).data}catch{return k=null,null}return s}getBackground(t){let e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,i){const s=this.getLayer().getClassName();let r,o;if(t&&t.className===s&&(!i||t&&t.style.backgroundColor&&$e(Pe(t.style.backgroundColor),Pe(i)))){const l=t.firstElementChild;l instanceof HTMLCanvasElement&&(o=l.getContext("2d"))}if(o&&Qn(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=s;let l=r.style;l.position="absolute",l.width="100%",l.height="100%",o=pt();const a=o.canvas;r.appendChild(a),l=a.style,l.position="absolute",l.left="0",l.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&i&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=i)}clipUnrotated(t,e,i){const s=ne(i),r=ie(i),o=ee(i),l=te(i);N(e.coordinateToPixelTransform,s),N(e.coordinateToPixelTransform,r),N(e.coordinateToPixelTransform,o),N(e.coordinateToPixelTransform,l);const a=this.inversePixelTransform;N(a,s),N(a,r),N(a,o),N(a,l),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(l[0]),Math.round(l[1])),t.clip()}prepareContainer(t,e){const i=t.extent,s=t.viewState.resolution,r=t.viewState.rotation,o=t.pixelRatio,l=Math.round(H(i)/s*o),a=Math.round(L(i)/s*o);mt(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,r,-l/2,-a/2),Wn(this.inversePixelTransform,this.pixelTransform);const u=qn(this.pixelTransform);if(this.useContainer(e,u,this.getBackground(t)),!this.containerReused){const h=this.context.canvas;h.width!=l||h.height!=a?(h.width=l,h.height=a):this.context.clearRect(0,0,l,a),u!==h.style.transform&&(h.style.transform=u)}}dispatchRenderEvent_(t,e,i){const s=this.getLayer();if(s.hasListener(t)){const r=new gi(t,this.inversePixelTransform,i,e);s.dispatchEvent(r)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(nt.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(nt.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new mi),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(nt.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(nt.POSTRENDER,this.context,t))}getRenderTransform(t,e,i,s,r,o,l){const a=r/2,u=o/2,h=s/e,c=-h,d=-t[0]+l,g=-t[1];return mt(this.tempTransform,a,u,h,c,-i,d,g)}disposeInternal(){delete this.frameState,super.disposeInternal()}};var Pi=wi;let Ai=class extends Pi{constructor(t){super(t),this.image=null}getImage(){return this.image?this.image.getImage():null}prepareFrame(t){const e=t.layerStatesArray[t.layerIndex],i=t.pixelRatio,s=t.viewState,r=s.resolution,o=this.getLayer().getSource(),l=t.viewHints;let a=t.extent;if(e.extent!==void 0&&(a=an(a,U(e.extent,s.projection))),!l[P.ANIMATING]&&!l[P.INTERACTING]&&!$t(a))if(o){const u=s.projection,h=o.getImage(a,r,i,u);h&&(this.loadImage(h)?this.image=h:h.getState()===b.EMPTY&&(this.image=null))}else this.image=null;return!!this.image}getData(t){const e=this.frameState;if(!e)return null;const i=this.getLayer(),s=N(e.pixelToCoordinateTransform,t.slice()),r=i.getExtent();if(r&&!Qe(r,s))return null;const o=this.image.getExtent(),l=this.image.getImage(),a=H(o),u=Math.floor(l.width*((s[0]-o[0])/a));if(u<0||u>=l.width)return null;const h=L(o),c=Math.floor(l.height*((o[3]-s[1])/h));return c<0||c>=l.height?null:this.getImageData(l,u,c)}renderFrame(t,e){const i=this.image,s=i.getExtent(),r=i.getResolution(),[o,l]=Array.isArray(r)?r:[r,r],a=i.getPixelRatio(),u=t.layerStatesArray[t.layerIndex],h=t.pixelRatio,c=t.viewState,d=c.center,g=c.resolution,f=h*o/(g*a),m=h*l/(g*a);this.prepareContainer(t,e);const _=this.context.canvas.width,y=this.context.canvas.height,p=this.getRenderContext(t);let I=!1,v=!0;if(u.extent){const A=U(u.extent,c.projection);v=at(A,t.extent),I=v&&!Je(A,t.extent),I&&this.clipUnrotated(p,t,A)}const E=i.getImage(),w=mt(this.tempTransform,_/2,y/2,f,m,0,a*(s[0]-d[0])/o,a*(d[1]-s[3])/l);this.renderedResolution=l*h/a;const st=E.width*w[0],rt=E.height*w[3];if(this.getLayer().getSource().getInterpolate()||(p.imageSmoothingEnabled=!1),this.preRender(p,t),v&&st>=.5&&rt>=.5){const A=w[4],qe=w[5],vt=u.opacity;vt!==1&&(p.save(),p.globalAlpha=vt),p.drawImage(E,0,0,+E.width,+E.height,A,qe,st,rt),vt!==1&&p.restore()}return this.postRender(this.context,t),I&&p.restore(),p.imageSmoothingEnabled=!0,this.container}};var Ti=Ai,Ni={PROPERTYCHANGE:"propertychange"};class Ne extends jt{constructor(t,e,i){super(t),this.key=e,this.oldValue=i}}let Oi=class extends Te{constructor(t){super(),this.on,this.once,this.un,Mi(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let i;i=`change:${t}`,this.hasListener(i)&&this.dispatchEvent(new Ne(i,t,e)),i=Ni.PROPERTYCHANGE,this.hasListener(i)&&this.dispatchEvent(new Ne(i,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,i){const s=this.values_||(this.values_={});if(i)s[t]=e;else{const r=s[t];s[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const i in t)this.set(i,t[i],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const i=this.values_[t];delete this.values_[t],In(this.values_)&&(this.values_=null),e||this.notify(t,i)}}};var Xt=Oi,S={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function Oe(n,t,e){return function(i,s,r,o,l){if(!i)return;if(!s&&!t)return i;const a=t?0:r[0]*s,u=t?0:r[1]*s,h=l?l[0]:0,c=l?l[1]:0;let d=n[0]+a/2+h,g=n[2]-a/2+h,f=n[1]+u/2+c,m=n[3]-u/2+c;d>g&&(d=(g+d)/2,g=d),f>m&&(f=(m+f)/2,m=f);let _=M(i[0],d,g),y=M(i[1],f,m);if(o&&e&&s){const p=30*s;_+=-p*Math.log(1+Math.max(0,d-i[0])/p)+p*Math.log(1+Math.max(0,i[0]-g)/p),y+=-p*Math.log(1+Math.max(0,f-i[1])/p)+p*Math.log(1+Math.max(0,i[1]-m)/p)}return[_,y]}}function bi(n){return n}function Li(n){return Math.pow(n,3)}function Fi(n){return 1-Li(1-n)}function Gi(n){return 3*n*n-2*n*n*n}function Zi(n,t,e,i,s,r,o){r=r||[],o=o||2;let l=0;for(let a=t;a<e;a+=i){const u=n[a],h=n[a+1];r[l++]=s[0]*u+s[2]*h+s[4],r[l++]=s[1]*u+s[3]*h+s[5];for(let c=2;c<o;c++)r[l++]=n[a+c]}return r&&r.length!=l&&(r.length=l),r}function Di(n,t,e,i,s,r,o){o=o||[];const l=Math.cos(s),a=Math.sin(s),u=r[0],h=r[1];let c=0;for(let d=t;d<e;d+=i){const g=n[d]-u,f=n[d+1]-h;o[c++]=u+g*l-f*a,o[c++]=h+g*a+f*l;for(let m=d+2;m<d+i;++m)o[c++]=n[m]}return o&&o.length!=c&&(o.length=c),o}function ji(n,t,e,i,s,r,o,l){l=l||[];const a=o[0],u=o[1];let h=0;for(let c=t;c<e;c+=i){const d=n[c]-a,g=n[c+1]-u;l[h++]=a+s*d,l[h++]=u+r*g;for(let f=c+2;f<c+i;++f)l[h++]=n[f]}return l&&l.length!=h&&(l.length=h),l}function zi(n,t,e,i,s,r,o){o=o||[];let l=0;for(let a=t;a<e;a+=i){o[l++]=n[a]+s,o[l++]=n[a+1]+r;for(let u=a+2;u<a+i;++u)o[l++]=n[u]}return o&&o.length!=l&&(o.length=l),o}const be=ft(),Xi=[NaN,NaN];let Vi=class extends Xt{constructor(){super(),this.extent_=Mt(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=Ri((t,e,i)=>{if(!i)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(i),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return C()}closestPointXY(t,e,i,s){return C()}containsXY(t,e){return this.closestPointXY(t,e,Xi,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return C()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&It(e),this.extentRevision_=this.getRevision()}return ln(this.extent_,t)}rotate(t,e){C()}scale(t,e,i){C()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return C()}getType(){return C()}applyTransform(t){C()}intersectsExtent(t){return C()}translate(t,e){C()}transform(t,e){const i=J(t),s=i.getUnits()=="tile-pixels"?function(r,o,l){const a=i.getExtent(),u=i.getWorldExtent(),h=L(u)/L(a);mt(be,u[0],u[3],h,-h,0,0,0);const c=Zi(r,0,r.length,l,be,o),d=ve(i,e);return d?d(c,c,l):c}:ve(i,e);return this.applyTransform(s),this}};var Ki=Vi;class Ui extends Ki{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return en(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return C()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=Le(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){C()}setLayout(t,e,i){let s;if(t)s=Le(t);else{for(let r=0;r<i;++r){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=Yi(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();Di(i,0,i.length,s,t,e,i),this.changed()}}scale(t,e,i){e===void 0&&(e=t),i||(i=ot(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();ji(s,0,s.length,r,t,e,i,s),this.changed()}}translate(t,e){const i=this.getFlatCoordinates();if(i){const s=this.getStride();zi(i,0,i.length,s,t,e,i),this.changed()}}}function Yi(n){let t;return n==2?t="XY":n==3?t="XYZ":n==4&&(t="XYZM"),t}function Le(n){let t;return n=="XY"?t=2:n=="XYZ"||n=="XYM"?t=3:n=="XYZM"&&(t=4),t}var Vt=Ui;function Fe(n,t,e,i){let s=0;const r=n[e-i],o=n[e-i+1];let l=0,a=0;for(;t<e;t+=i){const u=n[t]-r,h=n[t+1]-o;s+=a*u-l*h,l=u,a=h}return s/2}function ki(n,t,e,i){let s=0;for(let r=0,o=e.length;r<o;++r){const l=e[r];s+=Fe(n,t,l,i),t=l}return s}function Ge(n,t,e,i,s,r,o){const l=n[t],a=n[t+1],u=n[e]-l,h=n[e+1]-a;let c;if(u===0&&h===0)c=t;else{const d=((s-l)*u+(r-a)*h)/(u*u+h*h);if(d>1)c=e;else if(d>0){for(let g=0;g<i;++g)o[g]=dn(n[t+g],n[e+g],d);o.length=i;return}else c=t}for(let d=0;d<i;++d)o[d]=n[c+d];o.length=i}function Ze(n,t,e,i,s){let r=n[t],o=n[t+1];for(t+=i;t<e;t+=i){const l=n[t],a=n[t+1],u=j(r,o,l,a);u>s&&(s=u),r=l,o=a}return s}function Wi(n,t,e,i,s){for(let r=0,o=e.length;r<o;++r){const l=e[r];s=Ze(n,t,l,i,s),t=l}return s}function De(n,t,e,i,s,r,o,l,a,u,h){if(t==e)return u;let c,d;if(s===0){if(d=j(o,l,n[t],n[t+1]),d<u){for(c=0;c<i;++c)a[c]=n[t+c];return a.length=i,d}return u}h=h||[NaN,NaN];let g=t+i;for(;g<e;)if(Ge(n,g-i,g,i,o,l,h),d=j(o,l,h[0],h[1]),d<u){for(u=d,c=0;c<i;++c)a[c]=h[c];a.length=i,g+=i}else g+=i*Math.max((Math.sqrt(d)-Math.sqrt(u))/s|0,1);if(Ge(n,e-i,t,i,o,l,h),d=j(o,l,h[0],h[1]),d<u){for(u=d,c=0;c<i;++c)a[c]=h[c];a.length=i}return u}function Hi(n,t,e,i,s,r,o,l,a,u,h){h=h||[NaN,NaN];for(let c=0,d=e.length;c<d;++c){const g=e[c];u=De(n,t,g,i,s,r,o,l,a,u,h),t=g}return u}function Bi(n,t,e,i){for(let s=0,r=e.length;s<r;++s)n[t++]=e[s];return t}function je(n,t,e,i){for(let s=0,r=e.length;s<r;++s){const o=e[s];for(let l=0;l<i;++l)n[t++]=o[l]}return t}function qi(n,t,e,i,s){s=s||[];let r=0;for(let o=0,l=e.length;o<l;++o){const a=je(n,t,e[o],i);s[r++]=a,t=a}return s.length=r,s}function ze(n,t,e,i,s){s=s!==void 0?s:[];let r=0;for(let o=t;o<e;o+=i)s[r++]=n.slice(o,o+i);return s.length=r,s}function Qi(n,t,e,i,s){s=s!==void 0?s:[];let r=0;for(let o=0,l=e.length;o<l;++o){const a=e[o];s[r++]=ze(n,t,a,i,s[r]),t=a}return s.length=r,s}function Ji(n,t,e,i,s,r,o){const l=(e-t)/i;if(l<3){for(;t<e;t+=i)r[o++]=n[t],r[o++]=n[t+1];return o}const a=new Array(l);a[0]=1,a[l-1]=1;const u=[t,e-i];let h=0;for(;u.length>0;){const c=u.pop(),d=u.pop();let g=0;const f=n[d],m=n[d+1],_=n[c],y=n[c+1];for(let p=d+i;p<c;p+=i){const I=n[p],v=n[p+1],E=cn(I,v,f,m,_,y);E>g&&(h=p,g=E)}g>s&&(a[(h-t)/i]=1,d+i<h&&u.push(d,h),h+i<c&&u.push(h,c))}for(let c=0;c<l;++c)a[c]&&(r[o++]=n[t+c*i],r[o++]=n[t+c*i+1]);return o}function W(n,t){return t*Math.round(n/t)}function ts(n,t,e,i,s,r,o){if(t==e)return o;let l=W(n[t],s),a=W(n[t+1],s);t+=i,r[o++]=l,r[o++]=a;let u,h;do if(u=W(n[t],s),h=W(n[t+1],s),t+=i,t==e)return r[o++]=u,r[o++]=h,o;while(u==l&&h==a);for(;t<e;){const c=W(n[t],s),d=W(n[t+1],s);if(t+=i,c==u&&d==h)continue;const g=u-l,f=h-a,m=c-l,_=d-a;if(g*_==f*m&&(g<0&&m<g||g==m||g>0&&m>g)&&(f<0&&_<f||f==_||f>0&&_>f)){u=c,h=d;continue}r[o++]=u,r[o++]=h,l=u,a=h,u=c,h=d}return r[o++]=u,r[o++]=h,o}function es(n,t,e,i,s,r,o,l){for(let a=0,u=e.length;a<u;++a){const h=e[a];o=ts(n,t,h,i,s,r,o),l.push(o),t=h}return o}let ns=class Wt extends Vt{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Wt(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,i,s){return s<Bt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),De(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,i,s))}getArea(){return Fe(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return ze(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=Ji(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Wt(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=je(this.flatCoordinates,0,t,this.stride),this.changed()}};var Xe=ns;class Ht extends Vt{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new Ht(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,i,s){const r=this.flatCoordinates,o=j(t,e,r[0],r[1]);if(o<s){const l=this.stride;for(let a=0;a<l;++a)i[a]=r[a];return i.length=l,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return tn(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return qt(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Bi(this.flatCoordinates,0,t,this.stride),this.changed()}}var is=Ht;function ss(n,t,e,i,s){return!sn(s,function(r){return!D(n,t,e,i,r[0],r[1])})}function D(n,t,e,i,s,r){let o=0,l=n[e-i],a=n[e-i+1];for(;t<e;t+=i){const u=n[t],h=n[t+1];a<=r?h>r&&(u-l)*(r-a)-(s-l)*(h-a)>0&&o++:h<=r&&(u-l)*(r-a)-(s-l)*(h-a)<0&&o--,l=u,a=h}return o!==0}function Ve(n,t,e,i,s,r){if(e.length===0||!D(n,t,e[0],i,s,r))return!1;for(let o=1,l=e.length;o<l;++o)if(D(n,e[o-1],e[o],i,s,r))return!1;return!0}function rs(n,t,e,i,s,r,o){let l,a,u,h,c,d,g;const f=s[r+1],m=[];for(let p=0,I=e.length;p<I;++p){const v=e[p];for(h=n[v-i],d=n[v-i+1],l=t;l<v;l+=i)c=n[l],g=n[l+1],(f<=d&&g<=f||d<=f&&f<=g)&&(u=(f-d)/(g-d)*(c-h)+h,m.push(u)),h=c,d=g}let _=NaN,y=-1/0;for(m.sort(Jn),h=m[0],l=1,a=m.length;l<a;++l){c=m[l];const p=Math.abs(c-h);p>y&&(u=(h+c)/2,Ve(n,t,e,i,u,f)&&(_=u,y=p)),h=c}return isNaN(_)&&(_=s[r]),o?(o.push(_,f,y),o):[_,f,y]}function os(n,t,e,i,s){let r;for(t+=i;t<e;t+=i)if(r=s(n.slice(t-i,t),n.slice(t,t+i)),r)return r;return!1}function Ke(n,t,e,i,s,r){return r=r??Jt(Mt(),n,t,e,i),at(s,r)?r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]?!0:os(n,t,e,i,function(o,l){return hn(s,o,l)}):!1}function as(n,t,e,i,s){return!!(Ke(n,t,e,i,s)||D(n,t,e,i,s[0],s[1])||D(n,t,e,i,s[0],s[3])||D(n,t,e,i,s[2],s[1])||D(n,t,e,i,s[2],s[3]))}function ls(n,t,e,i,s){if(!as(n,t,e[0],i,s))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(ss(n,e[r-1],e[r],i,s)&&!Ke(n,e[r-1],e[r],i,s))return!1;return!0}function hs(n,t,e,i){for(;t<e-i;){for(let s=0;s<i;++s){const r=n[t+s];n[t+s]=n[e-i+s],n[e-i+s]=r}t+=i,e-=i}}function Ue(n,t,e,i){let s=0,r=n[e-i],o=n[e-i+1];for(;t<e;t+=i){const l=n[t],a=n[t+1];s+=(l-r)*(a+o),r=l,o=a}return s===0?void 0:s>0}function us(n,t,e,i,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const l=e[r],a=Ue(n,t,l,i);if(r===0){if(s&&a||!s&&!a)return!1}else if(s&&!a||!s&&a)return!1;t=l}return!0}function Ye(n,t,e,i,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const l=e[r],a=Ue(n,t,l,i);(r===0?s&&a||!s&&!a:s&&!a||!s&&a)&&hs(n,t,l,i),t=l}return t}class xt extends Vt{constructor(t,e,i){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&i?(this.setFlatCoordinates(e,t),this.ends_=i):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?ti(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new xt(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,i,s){return s<Bt(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Wi(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Hi(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,i,s))}containsXY(t,e){return Ve(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return ki(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),Ye(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,Qi(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=ot(this.getExtent());this.flatInteriorPoint_=rs(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new is(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Xe(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,i=this.ends_,s=[];let r=0;for(let o=0,l=i.length;o<l;++o){const a=i[o],u=new Xe(e.slice(r,a),t);s.push(u),r=a}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;us(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=Ye(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],i=[];return e.length=es(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,i),new xt(e,"XY",i)}getType(){return"Polygon"}intersectsExtent(t){return ls(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const i=qi(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=i.length===0?0:i[i.length-1],this.changed()}}function ke(n){if($t(n))throw new Error("Cannot create polygon from empty extent");const t=n[0],e=n[1],i=n[2],s=n[3],r=[t,e,t,s,i,s,i,e,t,e];return new xt(r,"XY",[r.length])}function Kt(n,t,e,i){const s=H(t)/e[0],r=L(t)/e[1];return i?Math.min(n,Math.max(s,r)):Math.min(n,Math.min(s,r))}function Ut(n,t,e){let i=Math.min(n,t);const s=50;return i*=Math.log(1+s*Math.max(0,n/t-1))/s+1,e&&(i=Math.max(i,e),i/=Math.log(1+s*Math.max(0,e/n-1))/s+1),M(i,e/2,t*2)}function cs(n,t,e,i){return t=t!==void 0?t:!0,function(s,r,o,l){if(s!==void 0){const a=n[0],u=n[n.length-1],h=e?Kt(a,e,o,i):a;if(l)return t?Ut(s,h,u):M(s,u,h);const c=Math.min(h,s),d=Math.floor(Ie(n,c,r));return n[d]>h&&d<n.length-1?n[d+1]:n[d]}}}function ds(n,t,e,i,s,r){return i=i!==void 0?i:!0,e=e!==void 0?e:0,function(o,l,a,u){if(o!==void 0){const h=s?Kt(t,s,a,r):t;if(u)return i?Ut(o,h,e):M(o,e,h);const c=1e-9,d=Math.ceil(Math.log(t/h)/Math.log(n)-c),g=-l*(.5-c)+.5,f=Math.min(h,o),m=Math.floor(Math.log(t/f)/Math.log(n)+g),_=Math.max(d,m),y=t/Math.pow(n,_);return M(y,e,h)}}}function We(n,t,e,i,s){return e=e!==void 0?e:!0,function(r,o,l,a){if(r!==void 0){const u=i?Kt(n,i,l,s):n;return!e||!a?M(r,t,u):Ut(r,u,t)}}}function gs(n){if(n!==void 0)return 0}function He(n){if(n!==void 0)return n}function fs(n){const t=2*Math.PI/n;return function(e,i){if(i)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function ms(n){const t=B(5);return function(e,i){return i||e===void 0?e:Math.abs(e)<=t?0:e}}const ps=256,Yt=0;class _s extends Xt{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=Lt(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&Xn(),t.center&&(t.center=O(t.center,this.projection_)),t.extent&&(t.extent=U(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const l in S)delete e[l];this.setProperties(e,!0);const i=ys(t);this.maxResolution_=i.maxResolution,this.minResolution_=i.minResolution,this.zoomFactor_=i.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=i.minZoom;const s=Rs(t),r=i.constraint,o=Cs(t);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const i=this.getCenterInternal();if(i){const s=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(s[3]-e[3]+e[1]-s[1]),l=r/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([i[0]+o,i[1]-l])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let i=0;i<e.length;++i){let s=arguments[i];s.center&&(s=Object.assign({},s),s.center=O(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=O(s.anchor,this.getProjection())),e[i]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,i;e>1&&typeof arguments[e-1]=="function"&&(i=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const h=arguments[s];h.center&&this.setCenterInternal(h.center),h.zoom!==void 0?this.setZoom(h.zoom):h.resolution&&this.setResolution(h.resolution),h.rotation!==void 0&&this.setRotation(h.rotation)}if(s===e){i&&Ct(i,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),l=this.targetResolution_,a=this.targetRotation_;const u=[];for(;s<e;++s){const h=arguments[s],c={start:r,complete:!1,anchor:h.anchor,duration:h.duration!==void 0?h.duration:1e3,easing:h.easing||Gi,callback:i};if(h.center&&(c.sourceCenter=o,c.targetCenter=h.center.slice(),o=c.targetCenter),h.zoom!==void 0?(c.sourceResolution=l,c.targetResolution=this.getResolutionForZoom(h.zoom),l=c.targetResolution):h.resolution&&(c.sourceResolution=l,c.targetResolution=h.resolution,l=c.targetResolution),h.rotation!==void 0){c.sourceRotation=a;const d=re(h.rotation-a+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=a+d,a=c.targetRotation}xs(c)?c.complete=!0:r+=c.duration,u.push(c)}this.animations_.push(u),this.setHint(P.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[P.ANIMATING]>0}getInteracting(){return this.hints_[P.INTERACTING]>0}cancelAnimations(){this.setHint(P.ANIMATING,-this.hints_[P.ANIMATING]);let t;for(let e=0,i=this.animations_.length;e<i;++e){const s=this.animations_[e];if(s[0].callback&&Ct(s[0].callback,!1),!t)for(let r=0,o=s.length;r<o;++r){const l=s[r];if(!l.complete){t=l.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let i=this.animations_.length-1;i>=0;--i){const s=this.animations_[i];let r=!0;for(let o=0,l=s.length;o<l;++o){const a=s[o];if(a.complete)continue;const u=t-a.start;let h=a.duration>0?u/a.duration:1;h>=1?(a.complete=!0,h=1):r=!1;const c=a.easing(h);if(a.sourceCenter){const d=a.sourceCenter[0],g=a.sourceCenter[1],f=a.targetCenter[0],m=a.targetCenter[1];this.nextCenter_=a.targetCenter;const _=d+c*(f-d),y=g+c*(m-g);this.targetCenter_=[_,y]}if(a.sourceResolution&&a.targetResolution){const d=c===1?a.targetResolution:a.sourceResolution+c*(a.targetResolution-a.sourceResolution);if(a.anchor){const g=this.getViewportSize_(this.getRotation()),f=this.constraints_.resolution(d,0,g,!0);this.targetCenter_=this.calculateCenterZoom(f,a.anchor)}this.nextResolution_=a.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(a.sourceRotation!==void 0&&a.targetRotation!==void 0){const d=c===1?re(a.targetRotation+Math.PI,2*Math.PI)-Math.PI:a.sourceRotation+c*(a.targetRotation-a.sourceRotation);if(a.anchor){const g=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(g,a.anchor)}this.nextRotation_=a.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!a.complete)break}if(r){this.animations_[i]=null,this.setHint(P.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&Ct(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let i;const s=this.getCenterInternal();return s!==void 0&&(i=[s[0]-e[0],s[1]-e[1]],mn(i,t-this.getRotation()),fn(i,e)),i}calculateCenterZoom(t,e){let i;const s=this.getCenterInternal(),r=this.getResolution();if(s!==void 0&&r!==void 0){const o=e[0]-t*(e[0]-s[0])/r,l=e[1]-t*(e[1]-s[1])/r;i=[o,l]}return i}getViewportSize_(t){const e=this.viewportSize_;if(t){const i=e[0],s=e[1];return[Math.abs(i*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(i*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Me(t,this.getProjection())}getCenterInternal(){return this.get(S.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Yn(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();T(e,"The view center is not defined");const i=this.getResolution();T(i!==void 0,"The view resolution is not defined");const s=this.getRotation();return T(s!==void 0,"The view rotation is not defined"),rn(e,i,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(S.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(U(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const i=H(t)/e[0],s=L(t)/e[1];return Math.max(i,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),i=this.minResolution_,s=Math.log(e/i)/Math.log(t);return function(r){return e/Math.pow(t,r*s)}}getRotation(){return this.get(S.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),i=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,r=Math.log(i/s)/e;return function(o){return Math.log(i/o)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const i=this.padding_;return i&&(e=[e[0]-i[1]-i[3],e[1]-i[0]-i[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),i=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=kt(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,i)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:i,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,i,s;if(this.resolutions_){const r=Ie(this.resolutions_,t,1);e=r,i=this.resolutions_[r],r==this.resolutions_.length-1?s=2:s=i/this.resolutions_[r+1]}else i=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(i/t)/Math.log(s)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=M(Math.floor(t),0,this.resolutions_.length-2),i=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(i,M(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let i;if(T(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){T(!$t(t),"Cannot fit empty extent provided as `geometry`");const s=U(t,this.getProjection());i=ke(s)}else if(t.getType()==="Circle"){const s=U(t.getExtent(),this.getProjection());i=ke(s),i.rotate(this.getRotation(),ot(s))}else i=t;this.fitInternal(i,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),i=Math.cos(e),s=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let l=1/0,a=1/0,u=-1/0,h=-1/0;for(let c=0,d=r.length;c<d;c+=o){const g=r[c]*i-r[c+1]*s,f=r[c]*s+r[c+1]*i;l=Math.min(l,g),a=Math.min(a,f),u=Math.max(u,g),h=Math.max(h,f)}return[l,a,u,h]}fitInternal(t,e){e=e||{};let i=e.size;i||(i=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const l=this.rotatedExtentForGeometry(t);let a=this.getResolutionForExtentInternal(l,[i[0]-s[1]-s[3],i[1]-s[0]-s[2]]);a=isNaN(a)?o:Math.max(a,o),a=this.getConstrainedResolution(a,r?0:1);const u=this.getRotation(),h=Math.sin(u),c=Math.cos(u),d=ot(l);d[0]+=(s[1]-s[3])/2*a,d[1]+=(s[0]-s[2])/2*a;const g=d[0]*c-d[1]*h,f=d[1]*c+d[0]*h,m=this.getConstrainedCenter([g,f],a),_=e.callback?e.callback:zt;e.duration!==void 0?this.animateInternal({resolution:a,center:m,duration:e.duration,easing:e.easing},_):(this.targetResolution_=a,this.targetCenter_=m,this.applyTargetState_(!1,!0),Ct(_,!0))}centerOn(t,e,i){this.centerOnInternal(O(t,this.getProjection()),e,i)}centerOnInternal(t,e,i){this.setCenterInternal(kt(t,e,i,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,i,s){let r;const o=this.padding_;if(o&&t){const l=this.getViewportSizeMinusPadding_(-i),a=kt(t,s,[l[0]/2+o[3],l[1]/2+o[0]],e,i);r=[t[0]-a[0],t[1]-a[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Me(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&O(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const i=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,s,i);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=O(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const i=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,i);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&O(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const i=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,i),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,i),l=this.constraints_.center(this.targetCenter_,o,r,i,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(S.ROTATION)!==s&&this.set(S.ROTATION,s),this.get(S.RESOLUTION)!==o&&(this.set(S.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!l||!this.get(S.CENTER)||!lt(this.get(S.CENTER),l))&&this.set(S.CENTER,l),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,i){t=t!==void 0?t:200;const s=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),l=this.constraints_.resolution(this.targetResolution_,s,o),a=this.constraints_.center(this.targetCenter_,l,o,!1,this.calculateCenterShift(this.targetCenter_,l,r,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=l,this.targetRotation_=r,this.targetCenter_=a,this.applyTargetState_();return}i=i||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==l||this.getRotation()!==r||!this.getCenterInternal()||!lt(this.getCenterInternal(),a))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:a,resolution:l,duration:t,easing:Fi,anchor:i}))}beginInteraction(){this.resolveConstraints(0),this.setHint(P.INTERACTING,1)}endInteraction(t,e,i){i=i&&O(i,this.getProjection()),this.endInteractionInternal(t,e,i)}endInteractionInternal(t,e,i){this.getInteracting()&&(this.setHint(P.INTERACTING,-1),this.resolveConstraints(t,e,i))}getConstrainedCenter(t,e){const i=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),i)}getConstrainedZoom(t,e){const i=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(i,e))}getConstrainedResolution(t,e){e=e||0;const i=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,i)}}function Ct(n,t){setTimeout(function(){n(t)},0)}function Rs(n){if(n.extent!==void 0){const e=n.smoothExtentConstraint!==void 0?n.smoothExtentConstraint:!0;return Oe(n.extent,n.constrainOnlyCenter,e)}const t=Lt(n.projection,"EPSG:3857");if(n.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,Oe(e,!1,!1)}return bi}function ys(n){let t,e,i,s=n.minZoom!==void 0?n.minZoom:Yt,r=n.maxZoom!==void 0?n.maxZoom:28;const o=n.zoomFactor!==void 0?n.zoomFactor:2,l=n.multiWorld!==void 0?n.multiWorld:!1,a=n.smoothResolutionConstraint!==void 0?n.smoothResolutionConstraint:!0,u=n.showFullExtent!==void 0?n.showFullExtent:!1,h=Lt(n.projection,"EPSG:3857"),c=h.getExtent();let d=n.constrainOnlyCenter,g=n.extent;if(!l&&!g&&h.isGlobal()&&(d=!1,g=c),n.resolutions!==void 0){const f=n.resolutions;e=f[s],i=f[r]!==void 0?f[r]:f[f.length-1],n.constrainResolution?t=cs(f,a,!d&&g,u):t=We(e,i,a,!d&&g,u)}else{const f=(c?Math.max(H(c),L(c)):360*oe.degrees/h.getMetersPerUnit())/ps/Math.pow(2,Yt),m=f/Math.pow(2,28-Yt);e=n.maxResolution,e!==void 0?s=0:e=f/Math.pow(o,s),i=n.minResolution,i===void 0&&(n.maxZoom!==void 0?n.maxResolution!==void 0?i=e/Math.pow(o,r):i=f/Math.pow(o,r):i=m),r=s+Math.floor(Math.log(e/i)/Math.log(o)),i=e/Math.pow(o,r-s),n.constrainResolution?t=ds(o,e,i,a,!d&&g,u):t=We(e,i,a,!d&&g,u)}return{constraint:t,maxResolution:e,minResolution:i,minZoom:s,zoomFactor:o}}function Cs(n){if(n.enableRotation===void 0||n.enableRotation){const t=n.constrainRotation;return t===void 0||t===!0?ms():t===!1?He:typeof t=="number"?fs(t):He}return gs}function xs(n){return!(n.sourceCenter&&n.targetCenter&&!lt(n.sourceCenter,n.targetCenter)||n.sourceResolution!==n.targetResolution||n.sourceRotation!==n.targetRotation)}function kt(n,t,e,i,s){const r=Math.cos(-s);let o=Math.sin(-s),l=n[0]*r-n[1]*o,a=n[1]*r+n[0]*o;l+=(t[0]/2-e[0])*i,a+=(e[1]-t[1]/2)*i,o=-o;const u=l*r-a*o,h=a*r+l*o;return[u,h]}var Be=_s,R={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class vs extends Xt{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[R.OPACITY]=t.opacity!==void 0?t.opacity:1,T(typeof e[R.OPACITY]=="number","Layer opacity must be a number"),e[R.VISIBLE]=t.visible!==void 0?t.visible:!0,e[R.Z_INDEX]=t.zIndex,e[R.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[R.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[R.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[R.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},i=this.getZIndex();return e.opacity=M(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=i===void 0&&!e.managed?1/0:i,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return C()}getLayerStatesArray(t){return C()}getExtent(){return this.get(R.EXTENT)}getMaxResolution(){return this.get(R.MAX_RESOLUTION)}getMinResolution(){return this.get(R.MIN_RESOLUTION)}getMinZoom(){return this.get(R.MIN_ZOOM)}getMaxZoom(){return this.get(R.MAX_ZOOM)}getOpacity(){return this.get(R.OPACITY)}getSourceState(){return C()}getVisible(){return this.get(R.VISIBLE)}getZIndex(){return this.get(R.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(R.EXTENT,t)}setMaxResolution(t){this.set(R.MAX_RESOLUTION,t)}setMinResolution(t){this.set(R.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(R.MAX_ZOOM,t)}setMinZoom(t){this.set(R.MIN_ZOOM,t)}setOpacity(t){T(typeof t=="number","Layer opacity must be a number"),this.set(R.OPACITY,t)}setVisible(t){this.set(R.VISIBLE,t)}setZIndex(t){this.set(R.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}var Ms=vs;class Es extends Ms{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(R.SOURCE,this.handleSourcePropertyChange_);const i=t.source?t.source:null;this.setSource(i)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(R.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(it(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=Y(t,Rt.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const i=this.getMapInternal();!t&&i&&(t=i.getView()),t instanceof Be?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&i&&(e.layerStatesArray=i.getLayerGroup().getLayerStatesArray());let s;if(e.layerStatesArray){if(s=e.layerStatesArray.find(o=>o.layer===this),!s)return!1}else s=this.getLayerState();const r=this.getExtent();return Is(s,e.viewState)&&(!r||at(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const i=t instanceof Be?t.getViewStateAndExtent():t;let s=e(i);return Array.isArray(s)||(s=[s]),s}render(t,e){const i=this.getRenderer();return i.prepareFrame(t)?(this.rendered=!0,i.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(R.MAP,t)}getMapInternal(){return this.get(R.MAP)}setMap(t){this.mapPrecomposeKey_&&(it(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(it(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=Y(t,nt.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=Y(this,Rt.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,i=this.getLayerState(!1);T(!e.some(s=>s.layer===i.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(i)}setSource(t){this.set(R.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function Is(n,t){if(!n.visible)return!1;const e=t.resolution;if(e<n.minResolution||e>=n.maxResolution)return!1;const i=t.zoom;return i>n.minZoom&&i<=n.maxZoom}var $s=Es;class Ss extends $s{constructor(t){t=t||{},super(t)}}var ws=Ss;class Ps extends ws{constructor(t){super(t)}createRenderer(){return new Ti(this)}getData(t){return super.getData(t)}}var As=Ps;export{As as default};
