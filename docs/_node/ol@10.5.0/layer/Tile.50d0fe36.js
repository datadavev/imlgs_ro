var y={IDLE:0,LOADING:1,LOADED:2,ERROR:3,EMPTY:4};function ke(i){return Math.pow(i,3)}function hi(i){return 1-ke(1-i)}function li(i){return 3*i*i-2*i*i*i}var ot={CHANGE:"change",ERROR:"error",LOAD:"load"};let ui=class{constructor(){this.disposed=!1}dispose(){this.disposed||(this.disposed=!0,this.disposeInternal())}disposeInternal(){}};var Ue=ui;function Ve(i,t){return i>t?1:i<t?-1:0}function qe(i,t,e){if(i[0]<=t)return 0;const n=i.length;if(t<=i[n-1])return n-1;if(typeof e=="function"){for(let s=1;s<n;++s){const r=i[s];if(r===t)return s;if(r<t)return e(t,i[s-1],r)>0?s-1:s}return n-1}if(e>0){for(let s=1;s<n;++s)if(i[s]<t)return s-1;return n-1}if(e<0){for(let s=1;s<n;++s)if(i[s]<=t)return s;return n-1}for(let s=1;s<n;++s){if(i[s]==t)return s;if(i[s]<t)return i[s-1]-t<t-i[s]?s-1:s}return n-1}function ci(i,t){const e=Array.isArray(t)?t:[t],n=e.length;for(let s=0;s<n;s++)i[i.length]=e[s]}function He(i,t){const e=i.length;if(e!==t.length)return!1;for(let n=0;n<e;n++)if(i[n]!==t[n])return!1;return!0}function ae(){}function di(i){let t,e,n;return function(){const s=Array.prototype.slice.call(arguments);return(!e||this!==n||!He(s,e))&&(n=this,e=s,t=i.apply(this,arguments)),t}}function Be(i){for(const t in i)delete i[t]}function gi(i){let t;for(t in i)return!1;return!t}let fi=class{constructor(t){this.propagationStopped,this.defaultPrevented,this.type=t,this.target=null}preventDefault(){this.defaultPrevented=!0}stopPropagation(){this.propagationStopped=!0}};var he=fi;let _i=class extends Ue{constructor(t){super(),this.eventTarget_=t,this.pendingRemovals_=null,this.dispatching_=null,this.listeners_=null}addEventListener(t,e){if(!t||!e)return;const n=this.listeners_||(this.listeners_={}),s=n[t]||(n[t]=[]);s.includes(e)||s.push(e)}dispatchEvent(t){const e=typeof t=="string",n=e?t:t.type,s=this.listeners_&&this.listeners_[n];if(!s)return;const r=e?new he(t):t;r.target||(r.target=this.eventTarget_||this);const o=this.dispatching_||(this.dispatching_={}),a=this.pendingRemovals_||(this.pendingRemovals_={});n in o||(o[n]=0,a[n]=0),++o[n];let h;for(let u=0,l=s.length;u<l;++u)if("handleEvent"in s[u]?h=s[u].handleEvent(r):h=s[u].call(this,r),h===!1||r.propagationStopped){h=!1;break}if(--o[n]===0){let u=a[n];for(delete a[n];u--;)this.removeEventListener(n,ae);delete o[n]}return h}disposeInternal(){this.listeners_&&Be(this.listeners_)}getListeners(t){return this.listeners_&&this.listeners_[t]||void 0}hasListener(t){return this.listeners_?t?t in this.listeners_:Object.keys(this.listeners_).length>0:!1}removeEventListener(t,e){if(!this.listeners_)return;const n=this.listeners_[t];if(!n)return;const s=n.indexOf(e);s!==-1&&(this.pendingRemovals_&&t in this.pendingRemovals_?(n[s]=ae,++this.pendingRemovals_[t]):(n.splice(s,1),n.length===0&&delete this.listeners_[t]))}};var Qe=_i;function O(){throw new Error("Unimplemented abstract method.")}let mi=0;function dt(i){return i.ol_uid||(i.ol_uid=String(++mi))}let pi=class extends Qe{constructor(t,e,n){super(),n=n||{},this.tileCoord=t,this.state=e,this.key="",this.transition_=n.transition===void 0?250:n.transition,this.transitionStarts_={},this.interpolate=!!n.interpolate}changed(){this.dispatchEvent(ot.CHANGE)}release(){this.setState(y.EMPTY)}getKey(){return this.key+"/"+this.tileCoord}getTileCoord(){return this.tileCoord}getState(){return this.state}setState(t){if(this.state!==y.EMPTY){if(this.state!==y.ERROR&&this.state>t)throw new Error("Tile load sequence violation");this.state=t,this.changed()}}load(){O()}getAlpha(t,e){if(!this.transition_)return 1;let n=this.transitionStarts_[t];if(!n)n=e,this.transitionStarts_[t]=n;else if(n===-1)return 1;const s=e-n+1e3/60;return s>=this.transition_?1:ke(s/this.transition_)}inTransition(t){return this.transition_?this.transitionStarts_[t]!==-1:!1}endTransition(t){this.transition_&&(this.transitionStarts_[t]=-1)}disposeInternal(){this.release(),super.disposeInternal()}};var le=pi;const gt=typeof navigator<"u"&&typeof navigator.userAgent<"u"?navigator.userAgent.toLowerCase():"",Ri=gt.includes("safari")&&!gt.includes("chrom");Ri&&(gt.includes("version/15.4")||/cpu (os|iphone os) 15_4 like mac os x/.test(gt)),gt.includes("webkit")&&gt.includes("edge"),gt.includes("macintosh");const xi=typeof WorkerGlobalScope<"u"&&typeof OffscreenCanvas<"u"&&self instanceof WorkerGlobalScope,vi=typeof Image<"u"&&Image.prototype.decode;(function(){let i=!1;try{const t=Object.defineProperty({},"passive",{get:function(){i=!0}});window.addEventListener("_",null,t),window.removeEventListener("_",null,t)}catch{}return i})();function at(i,t,e,n){let s;return e&&e.length?s=e.shift():xi?s=new OffscreenCanvas(i||300,t||300):s=document.createElement("canvas"),i&&(s.width=i),t&&(s.height=t),s.getContext("2d",n)}let ue;function Je(){return ue||(ue=at(1,1)),ue}function ce(i){const t=i.canvas;t.width=1,t.height=1,i.clearRect(0,0,1,1)}function de(i){return i instanceof Image||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageBitmap?i:null}const Ei=new Error("disposed"),yi=[256,256];let Ci=class extends le{constructor(t){const e=y.IDLE;super(t.tileCoord,e,{transition:t.transition,interpolate:t.interpolate}),this.loader_=t.loader,this.data_=null,this.error_=null,this.size_=t.size||null,this.controller_=t.controller||null}getSize(){if(this.size_)return this.size_;const t=de(this.data_);return t?[t.width,t.height]:yi}getData(){return this.data_}getError(){return this.error_}load(){if(this.state!==y.IDLE&&this.state!==y.ERROR)return;this.state=y.LOADING,this.changed();const t=this;this.loader_().then(function(e){t.data_=e,t.state=y.LOADED,t.changed()}).catch(function(e){t.error_=e,t.state=y.ERROR,t.changed()})}disposeInternal(){this.controller_&&(this.controller_.abort(Ei),this.controller_=null),super.disposeInternal()}};var tn=Ci,vt={IDLE:0,LOADED:2,ERROR:3};function ft(i,t,e,n,s){if(s){const o=e;e=function(a){return i.removeEventListener(t,e),o.call(n??this,a)}}else n&&n!==i&&(e=e.bind(n));const r={target:i,type:t,listener:e};return i.addEventListener(t,e),r}function Wt(i,t,e,n){return ft(i,t,e,n,!0)}function ht(i){i&&i.target&&(i.target.removeEventListener(i.type,i.listener),Be(i))}function Mi(i,t,e){const n=i;let s=!0,r=!1,o=!1;const a=[Wt(n,ot.LOAD,function(){o=!0,r||t()})];return n.src&&vi?(r=!0,n.decode().then(function(){s&&t()}).catch(function(h){s&&(o?t():e())})):a.push(Wt(n,ot.ERROR,e)),function(){s=!1,a.forEach(ht)}}let Ii=class extends le{constructor(t,e,n,s,r,o){super(t,e,o),this.crossOrigin_=s,this.src_=n,this.key=n,this.image_=new Image,s!==null&&(this.image_.crossOrigin=s),this.unlisten_=null,this.tileLoadFunction_=r}getImage(){return this.image_}setImage(t){this.image_=t,this.state=y.LOADED,this.unlistenImage_(),this.changed()}handleImageError_(){this.state=y.ERROR,this.unlistenImage_(),this.image_=Ti(),this.changed()}handleImageLoad_(){const t=this.image_;t.naturalWidth&&t.naturalHeight?this.state=y.LOADED:this.state=y.EMPTY,this.unlistenImage_(),this.changed()}load(){this.state==y.ERROR&&(this.state=y.IDLE,this.image_=new Image,this.crossOrigin_!==null&&(this.image_.crossOrigin=this.crossOrigin_)),this.state==y.IDLE&&(this.state=y.LOADING,this.changed(),this.tileLoadFunction_(this,this.src_),this.unlisten_=Mi(this.image_,this.handleImageLoad_.bind(this),this.handleImageError_.bind(this)))}unlistenImage_(){this.unlisten_&&(this.unlisten_(),this.unlisten_=null)}disposeInternal(){this.unlistenImage_(),this.image_=null,super.disposeInternal()}};function Ti(){const i=at(1,1);return i.fillStyle="rgba(0,0,0,0)",i.fillRect(0,0,1,1),i.canvas}var Si=Ii;let $i=class{constructor(t,e,n,s){this.minX=t,this.maxX=e,this.minY=n,this.maxY=s}contains(t){return this.containsXY(t[1],t[2])}containsTileRange(t){return this.minX<=t.minX&&t.maxX<=this.maxX&&this.minY<=t.minY&&t.maxY<=this.maxY}containsXY(t,e){return this.minX<=t&&t<=this.maxX&&this.minY<=e&&e<=this.maxY}equals(t){return this.minX==t.minX&&this.minY==t.minY&&this.maxX==t.maxX&&this.maxY==t.maxY}extend(t){t.minX<this.minX&&(this.minX=t.minX),t.maxX>this.maxX&&(this.maxX=t.maxX),t.minY<this.minY&&(this.minY=t.minY),t.maxY>this.maxY&&(this.maxY=t.maxY)}getHeight(){return this.maxY-this.minY+1}getSize(){return[this.getWidth(),this.getHeight()]}getWidth(){return this.maxX-this.minX+1}intersects(t){return this.minX<=t.maxX&&this.maxX>=t.minX&&this.minY<=t.maxY&&this.maxY>=t.minY}};var wi=$i,L={UNKNOWN:0,INTERSECTING:1,ABOVE:2,RIGHT:4,BELOW:8,LEFT:16};function en(i){const t=_t();for(let e=0,n=i.length;e<n;++e)Kt(t,i[e]);return t}function nn(i,t,e){let n,s;return t<i[0]?n=i[0]-t:i[2]<t?n=t-i[2]:n=0,e<i[1]?s=i[1]-e:i[3]<e?s=e-i[3]:s=0,n*n+s*s}function sn(i,t){return rn(i,t[0],t[1])}function rn(i,t,e){return i[0]<=t&&t<=i[2]&&i[1]<=e&&e<=i[3]}function on(i,t){const e=i[0],n=i[1],s=i[2],r=i[3],o=t[0],a=t[1];let h=L.UNKNOWN;return o<e?h=h|L.LEFT:o>s&&(h=h|L.RIGHT),a<n?h=h|L.BELOW:a>r&&(h=h|L.ABOVE),h===L.UNKNOWN&&(h=L.INTERSECTING),h}function _t(){return[1/0,1/0,-1/0,-1/0]}function ge(i,t,e,n,s){return s?(s[0]=i,s[1]=t,s[2]=e,s[3]=n,s):[i,t,e,n]}function fe(i){return ge(1/0,1/0,-1/0,-1/0,i)}function Pi(i,t){const e=i[0],n=i[1];return ge(e,n,e,n,t)}function Oi(i,t,e,n,s){const r=fe(s);return an(r,i,t,e,n)}function Ai(i,t){return i[0]==t[0]&&i[2]==t[2]&&i[1]==t[1]&&i[3]==t[3]}function bi(i,t){return t[0]<i[0]&&(i[0]=t[0]),t[2]>i[2]&&(i[2]=t[2]),t[1]<i[1]&&(i[1]=t[1]),t[3]>i[3]&&(i[3]=t[3]),i}function Kt(i,t){t[0]<i[0]&&(i[0]=t[0]),t[0]>i[2]&&(i[2]=t[0]),t[1]<i[1]&&(i[1]=t[1]),t[1]>i[3]&&(i[3]=t[1])}function an(i,t,e,n,s){for(;e<n;e+=s)Ni(i,t[e],t[e+1]);return i}function Ni(i,t,e){i[0]=Math.min(i[0],t),i[1]=Math.min(i[1],e),i[2]=Math.max(i[2],t),i[3]=Math.max(i[3],e)}function hn(i,t){let e;return e=t(me(i)),e||(e=t(pe(i)),e)||(e=t(Re(i)),e)||(e=t(bt(i)),e)?e:!1}function _e(i){let t=0;return xe(i)||(t=A(i)*U(i)),t}function me(i){return[i[0],i[1]]}function pe(i){return[i[2],i[1]]}function Et(i){return[(i[0]+i[2])/2,(i[1]+i[3])/2]}function Li(i,t,e,n,s){const[r,o,a,h,u,l,c,d]=ln(i,t,e,n);return ge(Math.min(r,a,u,c),Math.min(o,h,l,d),Math.max(r,a,u,c),Math.max(o,h,l,d),s)}function ln(i,t,e,n){const s=t*n[0]/2,r=t*n[1]/2,o=Math.cos(e),a=Math.sin(e),h=s*o,u=s*a,l=r*o,c=r*a,d=i[0],f=i[1];return[d-h+c,f-u-l,d-h-c,f-u+l,d+h-c,f+u+l,d+h+c,f+u-l,d-h+c,f-u-l]}function U(i){return i[3]-i[1]}function yt(i,t,e){const n=e||_t();return Nt(i,t)?(i[0]>t[0]?n[0]=i[0]:n[0]=t[0],i[1]>t[1]?n[1]=i[1]:n[1]=t[1],i[2]<t[2]?n[2]=i[2]:n[2]=t[2],i[3]<t[3]?n[3]=i[3]:n[3]=t[3]):fe(n),n}function bt(i){return[i[0],i[3]]}function Re(i){return[i[2],i[3]]}function A(i){return i[2]-i[0]}function Nt(i,t){return i[0]<=t[2]&&i[2]>=t[0]&&i[1]<=t[3]&&i[3]>=t[1]}function xe(i){return i[2]<i[0]||i[3]<i[1]}function Fi(i,t){return t?(t[0]=i[0],t[1]=i[1],t[2]=i[2],t[3]=i[3],t):i}function Di(i,t,e){let n=!1;const s=on(i,t),r=on(i,e);if(s===L.INTERSECTING||r===L.INTERSECTING)n=!0;else{const o=i[0],a=i[1],h=i[2],u=i[3],l=t[0],c=t[1],d=e[0],f=e[1],g=(f-c)/(d-l);let _,m;r&L.ABOVE&&!(s&L.ABOVE)&&(_=d-(f-u)/g,n=_>=o&&_<=h),!n&&r&L.RIGHT&&!(s&L.RIGHT)&&(m=f-(d-h)*g,n=m>=a&&m<=u),!n&&r&L.BELOW&&!(s&L.BELOW)&&(_=d-(f-a)/g,n=_>=o&&_<=h),!n&&r&L.LEFT&&!(s&L.LEFT)&&(m=f-(d-o)*g,n=m>=a&&m<=u)}return n}function Gi(i,t){const e=t.getExtent(),n=Et(i);if(t.canWrapX()&&(n[0]<e[0]||n[0]>=e[2])){const s=A(e),r=Math.floor((n[0]-e[0])/s)*s;i[0]-=r,i[2]-=r}return i}function Zi(i,t,e){if(t.canWrapX()){const n=t.getExtent();if(!isFinite(i[0])||!isFinite(i[2]))return[[n[0],i[1],n[2],i[3]]];Gi(i,t);const s=A(n);if(A(i)>s,i[0]<n[0])return[[i[0]+s,i[1],n[2],i[3]],[n[0],i[1],i[2],i[3]]];if(i[2]>n[2])return[[i[0],i[1],n[2],i[3]],[n[0],i[1],i[2]-s,i[3]]]}return[i]}function Xi(...i){console.warn(...i)}function F(i,t,e){return Math.min(Math.max(i,t),e)}function ji(i,t,e,n,s,r){const o=s-e,a=r-n;if(o!==0||a!==0){const h=((i-e)*o+(t-n)*a)/(o*o+a*a);h>1?(e=s,n=r):h>0&&(e+=o*h,n+=a*h)}return Ct(i,t,e,n)}function Ct(i,t,e,n){const s=e-i,r=n-t;return s*s+r*r}function Yi(i){const t=i.length;for(let n=0;n<t;n++){let s=n,r=Math.abs(i[n][n]);for(let a=n+1;a<t;a++){const h=Math.abs(i[a][n]);h>r&&(r=h,s=a)}if(r===0)return null;const o=i[s];i[s]=i[n],i[n]=o;for(let a=n+1;a<t;a++){const h=-i[a][n]/i[n][n];for(let u=n;u<t+1;u++)n==u?i[a][u]=0:i[a][u]+=h*i[n][u]}}const e=new Array(t);for(let n=t-1;n>=0;n--){e[n]=i[n][t]/i[n][n];for(let s=n-1;s>=0;s--)i[s][t]-=i[s][n]*e[n]}return e}function un(i){return i*180/Math.PI}function lt(i){return i*Math.PI/180}function Lt(i,t){const e=i%t;return e*t<0?e+t:e}function zi(i,t,e){return i+e*(t-i)}function Wi(i,t){const e=Math.pow(10,t);return Math.round(i*e)/e}function ve(i,t,e){if(i>=t&&i<e)return i;const n=e-t;return((i-t)%n+n)%n+t}function Ki(i,t){return i[0]+=+t[0],i[1]+=+t[1],i}function kt(i,t){let e=!0;for(let n=i.length-1;n>=0;--n)if(i[n]!=t[n]){e=!1;break}return e}function ki(i,t){const e=Math.cos(t),n=Math.sin(t),s=i[0]*e-i[1]*n,r=i[1]*e+i[0]*n;return i[0]=s,i[1]=r,i}const cn={radians:6370997/(2*Math.PI),degrees:2*Math.PI*6370997/360,ft:.3048,m:1,"us-ft":1200/3937};let Ui=class{constructor(t){this.code_=t.code,this.units_=t.units,this.extent_=t.extent!==void 0?t.extent:null,this.worldExtent_=t.worldExtent!==void 0?t.worldExtent:null,this.axisOrientation_=t.axisOrientation!==void 0?t.axisOrientation:"enu",this.global_=t.global!==void 0?t.global:!1,this.canWrapX_=!!(this.global_&&this.extent_),this.getPointResolutionFunc_=t.getPointResolution,this.defaultTileGrid_=null,this.metersPerUnit_=t.metersPerUnit}canWrapX(){return this.canWrapX_}getCode(){return this.code_}getExtent(){return this.extent_}getUnits(){return this.units_}getMetersPerUnit(){return this.metersPerUnit_||cn[this.units_]}getWorldExtent(){return this.worldExtent_}getAxisOrientation(){return this.axisOrientation_}isGlobal(){return this.global_}setGlobal(t){this.global_=t,this.canWrapX_=!!(t&&this.extent_)}getDefaultTileGrid(){return this.defaultTileGrid_}setDefaultTileGrid(t){this.defaultTileGrid_=t}setExtent(t){this.extent_=t,this.canWrapX_=!!(this.global_&&t)}setWorldExtent(t){this.worldExtent_=t}setGetPointResolution(t){this.getPointResolutionFunc_=t}getPointResolutionFunc(){return this.getPointResolutionFunc_}};var Ee=Ui;const Ft=6378137,Mt=Math.PI*Ft,Vi=[-Mt,-Mt,Mt,Mt],qi=[-180,-85,180,85],Ut=Ft*Math.log(Math.tan(Math.PI/2));let It=class extends Ee{constructor(t){super({code:t,units:"m",extent:Vi,global:!0,worldExtent:qi,getPointResolution:function(e,n){return e/Math.cosh(n[1]/Ft)}})}};const dn=[new It("EPSG:3857"),new It("EPSG:102100"),new It("EPSG:102113"),new It("EPSG:900913"),new It("http://www.opengis.net/def/crs/EPSG/0/3857"),new It("http://www.opengis.net/gml/srs/epsg.xml#3857")];function Hi(i,t,e,n){const s=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let r=0;r<s;r+=n){t[r]=Mt*i[r]/180;let o=Ft*Math.log(Math.tan(Math.PI*(+i[r+1]+90)/360));o>Ut?o=Ut:o<-Ut&&(o=-Ut),t[r+1]=o}return t}function Bi(i,t,e,n){const s=i.length;e=e>1?e:2,n=n??e,t===void 0&&(e>2?t=i.slice():t=new Array(s));for(let r=0;r<s;r+=n)t[r]=180*i[r]/Mt,t[r+1]=360*Math.atan(Math.exp(i[r+1]/Ft))/Math.PI-90;return t}const Qi=6378137,gn=[-180,-90,180,90],Ji=Math.PI*Qi/180;let mt=class extends Ee{constructor(t,e){super({code:t,units:"degrees",extent:gn,axisOrientation:e,global:!0,metersPerUnit:Ji,worldExtent:gn})}};const fn=[new mt("CRS:84"),new mt("EPSG:4326","neu"),new mt("urn:ogc:def:crs:OGC:1.3:CRS84"),new mt("urn:ogc:def:crs:OGC:2:84"),new mt("http://www.opengis.net/def/crs/OGC/1.3/CRS84"),new mt("http://www.opengis.net/gml/srs/epsg.xml#4326","neu"),new mt("http://www.opengis.net/def/crs/EPSG/0/4326","neu")];let ye={};function ts(i){return ye[i]||ye[i.replace(/urn:(x-)?ogc:def:crs:EPSG:(.*:)?(\w+)$/,"EPSG:$3")]||null}function es(i,t){ye[i]=t}let Tt={};function Dt(i,t,e){const n=i.getCode(),s=t.getCode();n in Tt||(Tt[n]={}),Tt[n][s]=e}function Ce(i,t){return i in Tt&&t in Tt[i]?Tt[i][t]:null}const Vt=.9996,z=.00669438,qt=z*z,Ht=qt*z,pt=z/(1-z),_n=Math.sqrt(1-z),St=(1-_n)/(1+_n),mn=St*St,Me=mn*St,Ie=Me*St,pn=Ie*St,Rn=1-z/4-3*qt/64-5*Ht/256,ns=3*z/8+3*qt/32+45*Ht/1024,is=15*qt/256+45*Ht/1024,ss=35*Ht/3072,rs=3/2*St-27/32*Me+269/512*pn,os=21/16*mn-55/32*Ie,as=151/96*Me-417/128*pn,hs=1097/512*Ie,Bt=6378137;function ls(i,t,e){const n=i-5e5,s=(e.north?t:t-1e7)/Vt/(Bt*Rn),r=s+rs*Math.sin(2*s)+os*Math.sin(4*s)+as*Math.sin(6*s)+hs*Math.sin(8*s),o=Math.sin(r),a=o*o,h=Math.cos(r),u=o/h,l=u*u,c=l*l,d=1-z*a,f=Math.sqrt(1-z*a),g=Bt/f,_=(1-z)/d,m=pt*h**2,x=m*m,p=n/(g*Vt),E=p*p,v=E*p,R=v*p,T=R*p,$=T*p,I=r-u/_*(E/2-R/24*(5+3*l+10*m-4*x-9*pt))+$/720*(61+90*l+298*m+45*c-252*pt-3*x);let S=(p-v/6*(1+2*l+m)+T/120*(5-2*m+28*l-3*x+8*pt+24*c))/h;return S=ve(S+lt(En(e.number)),-Math.PI,Math.PI),[un(S),un(I)]}const xn=-80,vn=84,us=-180,cs=180;function ds(i,t,e){i=ve(i,us,cs),t<xn?t=xn:t>vn&&(t=vn);const n=lt(t),s=Math.sin(n),r=Math.cos(n),o=s/r,a=o*o,h=a*a,u=lt(i),l=En(e.number),c=lt(l),d=Bt/Math.sqrt(1-z*s**2),f=pt*r**2,g=r*ve(u-c,-Math.PI,Math.PI),_=g*g,m=_*g,x=m*g,p=x*g,E=p*g,v=Bt*(Rn*n-ns*Math.sin(2*n)+is*Math.sin(4*n)-ss*Math.sin(6*n)),R=Vt*d*(g+m/6*(1-a+f)+p/120*(5-18*a+h+72*f-58*pt))+5e5;let T=Vt*(v+d*o*(_/2+x/24*(5-a+9*f+4*f**2)+E/720*(61-58*a+h+600*f-330*pt)));return e.north||(T+=1e7),[R,T]}function En(i){return(i-1)*6-180+3}const gs=[/^EPSG:(\d+)$/,/^urn:ogc:def:crs:EPSG::(\d+)$/,/^http:\/\/www\.opengis\.net\/def\/crs\/EPSG\/0\/(\d+)$/];function yn(i){let t=0;for(const s of gs){const r=i.match(s);if(r){t=parseInt(r[1]);break}}if(!t)return null;let e=0,n=!1;return t>32700&&t<32761?e=t-32700:t>32600&&t<32661&&(n=!0,e=t-32600),e?{number:e,north:n}:null}function Cn(i,t){return function(e,n,s,r){const o=e.length;s=s>1?s:2,r=r??s,n||(s>2?n=e.slice():n=new Array(o));for(let a=0;a<o;a+=r){const h=e[a],u=e[a+1],l=i(h,u,t);n[a]=l[0],n[a+1]=l[1]}return n}}function fs(i){return yn(i)?new Ee({code:i,units:"m"}):null}function _s(i){const t=yn(i.getCode());return t?{forward:Cn(ds,t),inverse:Cn(ls,t)}:null}const ms=63710088e-1;function Mn(i,t,e){e=e||ms;const n=lt(i[1]),s=lt(t[1]),r=(s-n)/2,o=lt(t[0]-i[0])/2,a=Math.sin(r)*Math.sin(r)+Math.sin(o)*Math.sin(o)*Math.cos(n)*Math.cos(s);return 2*e*Math.atan2(Math.sqrt(a),Math.sqrt(1-a))}const ps=[_s],Rs=[fs];let Te=!0;function xs(i){Te=!1}function In(i,t){if(t!==void 0){for(let e=0,n=i.length;e<n;++e)t[e]=i[e];t=t}else t=i.slice();return t}function Se(i){es(i.getCode(),i),Dt(i,i,In)}function vs(i){i.forEach(Se)}function tt(i){if(typeof i!="string")return i;const t=ts(i);if(t)return t;for(const e of Rs){const n=e(i);if(n)return n}return null}function Tn(i,t,e,n){i=tt(i);let s;const r=i.getPointResolutionFunc();if(r)s=r(t,e);else{const o=i.getUnits();if(o=="degrees"||n=="degrees")s=t;else{const a=$n(i,tt("EPSG:4326"));if(!a&&o!=="degrees")s=t*i.getMetersPerUnit();else{let u=[e[0]-t/2,e[1],e[0]+t/2,e[1],e[0],e[1]-t/2,e[0],e[1]+t/2];u=a(u,u,2);const l=Mn(u.slice(0,2),u.slice(2,4)),c=Mn(u.slice(4,6),u.slice(6,8));s=(l+c)/2}const h=i.getMetersPerUnit();h!==void 0&&(s/=h)}}return s}function Sn(i){vs(i),i.forEach(function(t){i.forEach(function(e){t!==e&&Dt(t,e,In)})})}function Es(i,t,e,n){i.forEach(function(s){t.forEach(function(r){Dt(s,r,e),Dt(r,s,n)})})}function $e(i,t){return i?typeof i=="string"?tt(i):i:tt(t)}function ys(i){return function(t,e,n,s){const r=t.length;n=n!==void 0?n:2,s=s??n,e=e!==void 0?e:new Array(r);for(let o=0;o<r;o+=s){const a=i(t.slice(o,o+n)),h=a.length;for(let u=0,l=s;u<l;++u)e[o+u]=u>=h?t[o+u]:a[u]}return e}}function $n(i,t){const e=i.getCode(),n=t.getCode();let s=Ce(e,n);if(s)return s;let r=null,o=null;for(const h of ps)r||(r=h(i)),o||(o=h(t));if(!r&&!o)return null;const a="EPSG:4326";if(o)if(r)s=we(r.inverse,o.forward);else{const h=Ce(e,a);h&&(s=we(h,o.forward))}else{const h=Ce(a,n);h&&(s=we(r.inverse,h))}return s&&(Se(i),Se(t),Dt(i,t,s)),s}function we(i,t){return function(e,n,s,r){return n=i(e,n,s,r),t(n,n,s,r)}}function Qt(i,t){const e=tt(i),n=tt(t);return $n(e,n)}function wn(i,t,e){const n=Qt(t,e);if(!n){const s=tt(t).getCode(),r=tt(e).getCode();throw new Error(`No transform available between ${s} and ${r}`)}return n(i,void 0,i.length)}function Pn(i,t){return i}function ut(i,t){return Te&&!kt(i,[0,0])&&i[0]>=-180&&i[0]<=180&&i[1]>=-90&&i[1]<=90&&(Te=!1,Xi("Call useGeographic() from ol/proj once to work with [longitude, latitude] coordinates.")),i}function Cs(i,t){return i}function Rt(i,t){return i}function Ms(){Sn(dn),Sn(fn),Es(fn,dn,Hi,Bi)}Ms();let Pe;const $t=[];function On(i,t,e,n,s){i.beginPath(),i.moveTo(0,0),i.lineTo(t,e),i.lineTo(n,s),i.closePath(),i.save(),i.clip(),i.fillRect(0,0,Math.max(t,n)+1,Math.max(e,s)),i.restore()}function Oe(i,t){return Math.abs(i[t*4]-210)>2||Math.abs(i[t*4+3]-.75*255)>2}function Is(){if(Pe===void 0){const i=at(6,6,$t);i.globalCompositeOperation="lighter",i.fillStyle="rgba(210, 0, 0, 0.75)",On(i,4,5,4,0),On(i,4,5,0,5);const t=i.getImageData(0,0,3,3).data;Pe=Oe(t,0)||Oe(t,4)||Oe(t,8),ce(i),$t.push(i.canvas)}return Pe}function An(i,t,e,n){const s=wn(e,t,i);let r=Tn(t,n,e);const o=t.getMetersPerUnit();o!==void 0&&(r*=o);const a=i.getMetersPerUnit();a!==void 0&&(r/=a);const h=i.getExtent();if(!h||sn(h,s)){const u=Tn(i,r,s)/r;isFinite(u)&&u>0&&(r/=u)}return r}function Ts(i,t,e,n){const s=Et(e);let r=An(i,t,s,n);return(!isFinite(r)||r<=0)&&hn(e,function(o){return r=An(i,t,o,n),isFinite(r)&&r>0}),r}function Ss(i,t,e,n,s,r,o,a,h,u,l,c,d,f){const g=at(Math.round(e*i),Math.round(e*t),$t);if(c||(g.imageSmoothingEnabled=!1),h.length===0)return g.canvas;g.scale(e,e);function _(R){return Math.round(R*e)/e}g.globalCompositeOperation="lighter";const m=_t();h.forEach(function(R,T,$){bi(m,R.extent)});let x;const p=e/n,E=(c?1:1+Math.pow(2,-24))/p;x=at(Math.round(A(m)*p),Math.round(U(m)*p),$t),c||(x.imageSmoothingEnabled=!1),h.forEach(function(R,T,$){if(R.image.width>0&&R.image.height>0){if(R.clipExtent){x.save();const b=(R.clipExtent[0]-m[0])*p,C=-(R.clipExtent[3]-m[3])*p,Z=A(R.clipExtent)*p,N=U(R.clipExtent)*p;x.rect(c?b:Math.round(b),c?C:Math.round(C),c?Z:Math.round(b+Z)-Math.round(b),c?N:Math.round(C+N)-Math.round(C)),x.clip()}const I=(R.extent[0]-m[0])*p,S=-(R.extent[3]-m[3])*p,D=A(R.extent)*p,G=U(R.extent)*p;x.drawImage(R.image,u,u,R.image.width-2*u,R.image.height-2*u,c?I:Math.round(I),c?S:Math.round(S),c?D:Math.round(I+D)-Math.round(I),c?G:Math.round(S+G)-Math.round(S)),R.clipExtent&&x.restore()}});const v=bt(o);return a.getTriangles().forEach(function(R,T,$){const I=R.source,S=R.target;let D=I[0][0],G=I[0][1],b=I[1][0],C=I[1][1],Z=I[2][0],N=I[2][1];const J=_((S[0][0]-v[0])/r),et=_(-(S[0][1]-v[1])/r),w=_((S[1][0]-v[0])/r),P=_(-(S[1][1]-v[1])/r),j=_((S[2][0]-v[0])/r),H=_(-(S[2][1]-v[1])/r),X=D,nt=G;D=0,G=0,b-=X,C-=nt,Z-=X,N-=nt;const Ot=[[b,C,0,0,w-J],[Z,N,0,0,j-J],[0,0,b,C,P-et],[0,0,Z,N,H-et]],it=Yi(Ot);if(!it)return;if(g.save(),g.beginPath(),Is()||!c){g.moveTo(w,P);const K=4,k=J-w,At=et-P;for(let Q=0;Q<K;Q++)g.lineTo(w+_((Q+1)*k/K),P+_(Q*At/(K-1))),Q!=K-1&&g.lineTo(w+_((Q+1)*k/K),P+_((Q+1)*At/(K-1)));g.lineTo(j,H)}else g.moveTo(w,P),g.lineTo(J,et),g.lineTo(j,H);g.clip(),g.transform(it[0],it[2],it[1],it[3],J,et),g.translate(m[0]-X,m[3]-nt);let B;if(x)B=x.canvas,g.scale(E,-E);else{const K=h[0],k=K.extent;B=K.image,g.scale(A(k)/B.width,-U(k)/B.height)}g.drawImage(B,0,0),g.restore()}),x&&(ce(x),$t.push(x.canvas)),l&&(g.save(),g.globalCompositeOperation="source-over",g.strokeStyle="black",g.lineWidth=1,a.getTriangles().forEach(function(R,T,$){const I=R.target,S=(I[0][0]-v[0])/r,D=-(I[0][1]-v[1])/r,G=(I[1][0]-v[0])/r,b=-(I[1][1]-v[1])/r,C=(I[2][0]-v[0])/r,Z=-(I[2][1]-v[1])/r;g.beginPath(),g.moveTo(G,b),g.lineTo(S,D),g.lineTo(C,Z),g.closePath(),g.stroke()}),g.restore()),g.canvas}function W(i,t){if(!i)throw new Error(t)}new Array(6);function Jt(){return[1,0,0,1,0,0]}function V(i,t){const e=t[0],n=t[1];return t[0]=i[0]*e+i[2]*n+i[4],t[1]=i[1]*e+i[3]*n+i[5],t}function te(i,t,e,n,s,r,o,a){const h=Math.sin(r),u=Math.cos(r);return i[0]=n*u,i[1]=s*h,i[2]=-n*h,i[3]=s*u,i[4]=o*n*u-a*n*h+t,i[5]=o*s*h+a*s*u+e,i}function $s(i,t){const e=ws(t);W(e!==0,"Transformation matrix cannot be inverted");const n=t[0],s=t[1],r=t[2],o=t[3],a=t[4],h=t[5];return i[0]=o/e,i[1]=-s/e,i[2]=-r/e,i[3]=n/e,i[4]=(r*h-o*a)/e,i[5]=-(n*h-s*a)/e,i}function ws(i){return i[0]*i[3]-i[1]*i[2]}const Ps=[1e5,1e5,1e5,1e5,2,2];function Os(i){return"matrix("+i.join(", ")+")"}function bn(i){return i.substring(7,i.length-1).split(",").map(parseFloat)}function As(i,t){const e=bn(i),n=bn(t);for(let s=0;s<6;++s)if(Math.round((e[s]-n[s])*Ps[s])!==0)return!1;return!0}const bs=10,Nn=.25;let Ns=class{constructor(t,e,n,s,r,o,a){this.sourceProj_=t,this.targetProj_=e;let h={};const u=a?ys(E=>V(a,wn(E,this.targetProj_,this.sourceProj_))):Qt(this.targetProj_,this.sourceProj_);this.transformInv_=function(E){const v=E[0]+"/"+E[1];return h[v]||(h[v]=u(E)),h[v]},this.maxSourceExtent_=s,this.errorThresholdSquared_=r*r,this.triangles_=[],this.wrapsXInSource_=!1,this.canWrapXInSource_=this.sourceProj_.canWrapX()&&!!s&&!!this.sourceProj_.getExtent()&&A(s)>=A(this.sourceProj_.getExtent()),this.sourceWorldWidth_=this.sourceProj_.getExtent()?A(this.sourceProj_.getExtent()):null,this.targetWorldWidth_=this.targetProj_.getExtent()?A(this.targetProj_.getExtent()):null;const l=bt(n),c=Re(n),d=pe(n),f=me(n),g=this.transformInv_(l),_=this.transformInv_(c),m=this.transformInv_(d),x=this.transformInv_(f),p=bs+(o?Math.max(0,Math.ceil(Math.log2(_e(n)/(o*o*256*256)))):0);if(this.addQuad_(l,c,d,f,g,_,m,x,p),this.wrapsXInSource_){let E=1/0;this.triangles_.forEach(function(v,R,T){E=Math.min(E,v.source[0][0],v.source[1][0],v.source[2][0])}),this.triangles_.forEach(v=>{if(Math.max(v.source[0][0],v.source[1][0],v.source[2][0])-E>this.sourceWorldWidth_/2){const R=[[v.source[0][0],v.source[0][1]],[v.source[1][0],v.source[1][1]],[v.source[2][0],v.source[2][1]]];R[0][0]-E>this.sourceWorldWidth_/2&&(R[0][0]-=this.sourceWorldWidth_),R[1][0]-E>this.sourceWorldWidth_/2&&(R[1][0]-=this.sourceWorldWidth_),R[2][0]-E>this.sourceWorldWidth_/2&&(R[2][0]-=this.sourceWorldWidth_);const T=Math.min(R[0][0],R[1][0],R[2][0]);Math.max(R[0][0],R[1][0],R[2][0])-T<this.sourceWorldWidth_/2&&(v.source=R)}})}h={}}addTriangle_(t,e,n,s,r,o){this.triangles_.push({source:[s,r,o],target:[t,e,n]})}addQuad_(t,e,n,s,r,o,a,h,u){const l=en([r,o,a,h]),c=this.sourceWorldWidth_?A(l)/this.sourceWorldWidth_:null,d=this.sourceWorldWidth_,f=this.sourceProj_.canWrapX()&&c>.5&&c<1;let g=!1;if(u>0){if(this.targetProj_.isGlobal()&&this.targetWorldWidth_){const m=en([t,e,n,s]);g=A(m)/this.targetWorldWidth_>Nn||g}!f&&this.sourceProj_.isGlobal()&&c&&(g=c>Nn||g)}if(!g&&this.maxSourceExtent_&&isFinite(l[0])&&isFinite(l[1])&&isFinite(l[2])&&isFinite(l[3])&&!Nt(l,this.maxSourceExtent_))return;let _=0;if(!g&&(!isFinite(r[0])||!isFinite(r[1])||!isFinite(o[0])||!isFinite(o[1])||!isFinite(a[0])||!isFinite(a[1])||!isFinite(h[0])||!isFinite(h[1]))){if(u>0)g=!0;else if(_=(!isFinite(r[0])||!isFinite(r[1])?8:0)+(!isFinite(o[0])||!isFinite(o[1])?4:0)+(!isFinite(a[0])||!isFinite(a[1])?2:0)+(!isFinite(h[0])||!isFinite(h[1])?1:0),_!=1&&_!=2&&_!=4&&_!=8)return}if(u>0){if(!g){const m=[(t[0]+n[0])/2,(t[1]+n[1])/2],x=this.transformInv_(m);let p;f?p=(Lt(r[0],d)+Lt(a[0],d))/2-Lt(x[0],d):p=(r[0]+a[0])/2-x[0];const E=(r[1]+a[1])/2-x[1];g=p*p+E*E>this.errorThresholdSquared_}if(g){if(Math.abs(t[0]-n[0])<=Math.abs(t[1]-n[1])){const m=[(e[0]+n[0])/2,(e[1]+n[1])/2],x=this.transformInv_(m),p=[(s[0]+t[0])/2,(s[1]+t[1])/2],E=this.transformInv_(p);this.addQuad_(t,e,m,p,r,o,x,E,u-1),this.addQuad_(p,m,n,s,E,x,a,h,u-1)}else{const m=[(t[0]+e[0])/2,(t[1]+e[1])/2],x=this.transformInv_(m),p=[(n[0]+s[0])/2,(n[1]+s[1])/2],E=this.transformInv_(p);this.addQuad_(t,m,p,s,r,x,E,h,u-1),this.addQuad_(m,e,n,p,x,o,a,E,u-1)}return}}if(f){if(!this.canWrapXInSource_)return;this.wrapsXInSource_=!0}_&11||this.addTriangle_(t,n,s,r,a,h),_&14||this.addTriangle_(t,n,e,r,a,o),_&&(_&13||this.addTriangle_(e,s,t,o,h,r),_&7||this.addTriangle_(e,s,n,o,h,a))}calculateSourceExtent(){const t=_t();return this.triangles_.forEach(function(e,n,s){const r=e.source;Kt(t,r[0]),Kt(t,r[1]),Kt(t,r[2])}),t}getTriangles(){return this.triangles_}};var Ls=Ns;const Fs=.5;let Ds=class extends le{constructor(t,e,n,s,r,o,a,h,u,l,c,d){super(r,y.IDLE,d),this.renderEdges_=c!==void 0?c:!1,this.pixelRatio_=a,this.gutter_=h,this.canvas_=null,this.sourceTileGrid_=e,this.targetTileGrid_=s,this.wrappedTileCoord_=o||r,this.sourceTiles_=[],this.sourcesListenerKeys_=null,this.sourceZ_=0,this.clipExtent_=t.canWrapX()?t.getExtent():void 0;const f=s.getTileCoordExtent(this.wrappedTileCoord_),g=this.targetTileGrid_.getExtent();let _=this.sourceTileGrid_.getExtent();const m=g?yt(f,g):f;if(_e(m)===0){this.state=y.EMPTY;return}const x=t.getExtent();x&&(_?_=yt(_,x):_=x);const p=s.getResolution(this.wrappedTileCoord_[0]),E=Ts(t,n,m,p);if(!isFinite(E)||E<=0){this.state=y.EMPTY;return}const v=l!==void 0?l:Fs;if(this.triangulation_=new Ls(t,n,m,_,E*v,p),this.triangulation_.getTriangles().length===0){this.state=y.EMPTY;return}this.sourceZ_=e.getZForResolution(E);let R=this.triangulation_.calculateSourceExtent();if(_&&(t.canWrapX()?(R[1]=F(R[1],_[1],_[3]),R[3]=F(R[3],_[1],_[3])):R=yt(R,_)),!_e(R))this.state=y.EMPTY;else{let T=0,$=0;t.canWrapX()&&(T=A(x),$=Math.floor((R[0]-x[0])/T)),Zi(R.slice(),t).forEach(I=>{const S=e.getTileRangeForExtentAndZ(I,this.sourceZ_);for(let D=S.minX;D<=S.maxX;D++)for(let G=S.minY;G<=S.maxY;G++){const b=u(this.sourceZ_,D,G,a);if(b){const C=$*T;this.sourceTiles_.push({tile:b,offset:C})}}++$}),this.sourceTiles_.length===0&&(this.state=y.EMPTY)}}getImage(){return this.canvas_}reproject_(){const t=[];if(this.sourceTiles_.forEach(e=>{const n=e.tile;if(n&&n.getState()==y.LOADED){const s=this.sourceTileGrid_.getTileCoordExtent(n.tileCoord);s[0]+=e.offset,s[2]+=e.offset;const r=this.clipExtent_?.slice();r&&(r[0]+=e.offset,r[2]+=e.offset),t.push({extent:s,clipExtent:r,image:n.getImage()})}}),this.sourceTiles_.length=0,t.length===0)this.state=y.ERROR;else{const e=this.wrappedTileCoord_[0],n=this.targetTileGrid_.getTileSize(e),s=typeof n=="number"?n:n[0],r=typeof n=="number"?n:n[1],o=this.targetTileGrid_.getResolution(e),a=this.sourceTileGrid_.getResolution(this.sourceZ_),h=this.targetTileGrid_.getTileCoordExtent(this.wrappedTileCoord_);this.canvas_=Ss(s,r,this.pixelRatio_,a,this.sourceTileGrid_.getExtent(),o,h,this.triangulation_,t,this.gutter_,this.renderEdges_,this.interpolate),this.state=y.LOADED}this.changed()}load(){if(this.state==y.IDLE){this.state=y.LOADING,this.changed();let t=0;this.sourcesListenerKeys_=[],this.sourceTiles_.forEach(({tile:e})=>{const n=e.getState();if(n==y.IDLE||n==y.LOADING){t++;const s=ft(e,ot.CHANGE,r=>{const o=e.getState();(o==y.LOADED||o==y.ERROR||o==y.EMPTY)&&(ht(s),t--,t===0&&(this.unlistenSources_(),this.reproject_()))});this.sourcesListenerKeys_.push(s)}}),t===0?setTimeout(this.reproject_.bind(this),0):this.sourceTiles_.forEach(function({tile:e},n,s){e.getState()==y.IDLE&&e.load()})}}unlistenSources_(){this.sourcesListenerKeys_.forEach(ht),this.sourcesListenerKeys_=null}release(){this.canvas_&&(ce(this.canvas_.getContext("2d")),$t.push(this.canvas_),this.canvas_=null),super.release()}};var Gs=Ds;function Zs(i,t){return Array.isArray(i)?i:(t===void 0?t=[i,i]:(t[0]=i,t[1]=i),t)}let Xs=class{constructor(t){this.highWaterMark=t!==void 0?t:2048,this.count_=0,this.entries_={},this.oldest_=null,this.newest_=null}deleteOldest(){const t=this.pop();t instanceof Ue&&t.dispose()}canExpireCache(){return this.highWaterMark>0&&this.getCount()>this.highWaterMark}expireCache(t){for(;this.canExpireCache();)this.deleteOldest()}clear(){for(;this.oldest_;)this.deleteOldest()}containsKey(t){return this.entries_.hasOwnProperty(t)}forEach(t){let e=this.oldest_;for(;e;)t(e.value_,e.key_,this),e=e.newer}get(t,e){const n=this.entries_[t];return W(n!==void 0,"Tried to get a value for a key that does not exist in the cache"),n===this.newest_||(n===this.oldest_?(this.oldest_=this.oldest_.newer,this.oldest_.older=null):(n.newer.older=n.older,n.older.newer=n.newer),n.newer=null,n.older=this.newest_,this.newest_.newer=n,this.newest_=n),n.value_}remove(t){const e=this.entries_[t];return W(e!==void 0,"Tried to get a value for a key that does not exist in the cache"),e===this.newest_?(this.newest_=e.older,this.newest_&&(this.newest_.newer=null)):e===this.oldest_?(this.oldest_=e.newer,this.oldest_&&(this.oldest_.older=null)):(e.newer.older=e.older,e.older.newer=e.newer),delete this.entries_[t],--this.count_,e.value_}getCount(){return this.count_}getKeys(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.key_;return t}getValues(){const t=new Array(this.count_);let e=0,n;for(n=this.newest_;n;n=n.older)t[e++]=n.value_;return t}peekLast(){return this.oldest_.value_}peekLastKey(){return this.oldest_.key_}peekFirstKey(){return this.newest_.key_}peek(t){return this.entries_[t]?.value_}pop(){const t=this.oldest_;return delete this.entries_[t.key_],t.newer&&(t.newer.older=null),this.oldest_=t.newer,this.oldest_||(this.newest_=null),--this.count_,t.value_}replace(t,e){this.get(t),this.entries_[t].value_=e}set(t,e){W(!(t in this.entries_),"Tried to set a value for a key that is used already");const n={key_:t,newer:null,older:this.newest_,value_:e};this.newest_?this.newest_.newer=n:this.oldest_=n,this.newest_=n,this.entries_[t]=n,++this.count_}setSize(t){this.highWaterMark=t}};var js=Xs;function Ln(i,t,e,n){return n!==void 0?(n[0]=i,n[1]=t,n[2]=e,n):[i,t,e]}function Ys(i,t,e){return i+"/"+t+"/"+e}const zs=[NaN,NaN,NaN,0];let Ae;function Ws(){return Ae||(Ae=at(1,1,void 0,{willReadFrequently:!0,desynchronized:!0})),Ae}const Ks=/^rgba?\(\s*(\d+%?)\s+(\d+%?)\s+(\d+%?)(?:\s*\/\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,ks=/^rgba?\(\s*(\d+)\s*,\s*(\d+)\s*,\s*(\d+)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Us=/^rgba?\(\s*(\d+%)\s*,\s*(\d+%)\s*,\s*(\d+%)(?:\s*,\s*(\d+%|\d*\.\d+|[01]))?\s*\)$/i,Vs=/^#([\da-f]{3,4}|[\da-f]{6}|[\da-f]{8})$/i;function ee(i,t){return i.endsWith("%")?Number(i.substring(0,i.length-1))/t:Number(i)}function Gt(i){throw new Error('failed to parse "'+i+'" as color')}function Fn(i){if(i.toLowerCase().startsWith("rgb")){const r=i.match(ks)||i.match(Ks)||i.match(Us);if(r){const o=r[4],a=100/255;return[F(ee(r[1],a)+.5|0,0,255),F(ee(r[2],a)+.5|0,0,255),F(ee(r[3],a)+.5|0,0,255),o!==void 0?F(ee(o,100),0,1):1]}Gt(i)}if(i.startsWith("#")){if(Vs.test(i)){const r=i.substring(1),o=r.length<=4?1:2,a=[0,0,0,255];for(let h=0,u=r.length;h<u;h+=o){let l=parseInt(r.substring(h,h+o),16);o===1&&(l+=l<<4),a[h/o]=l}return a[3]=a[3]/255,a}Gt(i)}const t=Ws();t.fillStyle="#abcdef";let e=t.fillStyle;t.fillStyle=i,t.fillStyle===e&&(t.fillStyle="#fedcba",e=t.fillStyle,t.fillStyle=i,t.fillStyle===e&&Gt(i));const n=t.fillStyle;if(n.startsWith("#")||n.startsWith("rgba"))return Fn(n);t.clearRect(0,0,1,1),t.fillRect(0,0,1,1);const s=Array.from(t.getImageData(0,0,1,1).data);return s[3]=Wi(s[3]/255,3),s}const qs=1024,Zt={};let be=0;function Hs(i){if(i==="none")return zs;if(Zt.hasOwnProperty(i))return Zt[i];if(be>=qs){let e=0;for(const n in Zt)e++&3||(delete Zt[n],--be)}const t=Fn(i);t.length!==4&&Gt(i);for(const e of t)isNaN(e)&&Gt(i);return Zt[i]=t,++be,t}function Dn(i){return Array.isArray(i)?i:Hs(i)}let Bs=class extends he{constructor(t,e,n,s){super(t),this.inversePixelTransform=e,this.frameState=n,this.context=s}};var Qs=Bs,Xt={PRERENDER:"prerender",POSTRENDER:"postrender",PRECOMPOSE:"precompose"};let Js=class{constructor(){this.instructions_=[],this.zIndex=0,this.offset_=0,this.context_=new Proxy(Je(),{get:(t,e)=>{if(typeof Je()[e]=="function")return this.push_(e),this.pushMethodArgs_},set:(t,e,n)=>(this.push_(e,n),!0)})}push_(...t){const e=this.instructions_,n=this.zIndex+this.offset_;e[n]||(e[n]=[]),e[n].push(...t)}pushMethodArgs_=(...t)=>(this.push_(t),this);pushFunction(t){this.push_(t)}getContext(){return this.context_}draw(t){this.instructions_.forEach(e=>{for(let n=0,s=e.length;n<s;++n){const r=e[n];if(typeof r=="function"){r(t);continue}const o=e[++n];if(typeof t[r]=="function")t[r](...o);else{if(typeof o=="function"){t[r]=o(t);continue}t[r]=o}}})}clear(){this.instructions_.length=0,this.zIndex=0,this.offset_=0}offset(){this.offset_=this.instructions_.length,this.zIndex=0}};var tr=Js;class ne extends Qe{constructor(){super(),this.on=this.onInternal,this.once=this.onceInternal,this.un=this.unInternal,this.revision_=0}changed(){++this.revision_,this.dispatchEvent(ot.CHANGE)}getRevision(){return this.revision_}onInternal(t,e){if(Array.isArray(t)){const n=t.length,s=new Array(n);for(let r=0;r<n;++r)s[r]=ft(this,t[r],e);return s}return ft(this,t,e)}onceInternal(t,e){let n;if(Array.isArray(t)){const s=t.length;n=new Array(s);for(let r=0;r<s;++r)n[r]=Wt(this,t[r],e)}else n=Wt(this,t,e);return e.ol_key=n,n}unInternal(t,e){const n=e.ol_key;if(n)er(n);else if(Array.isArray(t))for(let s=0,r=t.length;s<r;++s)this.removeEventListener(t[s],e);else this.removeEventListener(t,e)}}ne.prototype.on,ne.prototype.once,ne.prototype.un;function er(i){if(Array.isArray(i))for(let t=0,e=i.length;t<e;++t)ht(i[t]);else ht(i)}var Gn=ne;const nr=5;let ir=class extends Gn{constructor(t){super(),this.ready=!0,this.boundHandleImageChange_=this.handleImageChange_.bind(this),this.layer_=t,this.staleKeys_=new Array,this.maxStaleKeys=nr}getStaleKeys(){return this.staleKeys_}prependStaleKey(t){this.staleKeys_.unshift(t),this.staleKeys_.length>this.maxStaleKeys&&(this.staleKeys_.length=this.maxStaleKeys)}getFeatures(t){return O()}getData(t){return null}prepareFrame(t){return O()}renderFrame(t,e){return O()}forEachFeatureAtCoordinate(t,e,n,s,r){}getLayer(){return this.layer_}handleFontsChanged(){}handleImageChange_(t){const e=t.target;(e.getState()===vt.LOADED||e.getState()===vt.ERROR)&&this.renderIfReadyAndVisible()}loadImage(t){let e=t.getState();return e!=vt.LOADED&&e!=vt.ERROR&&t.addEventListener(ot.CHANGE,this.boundHandleImageChange_),e==vt.IDLE&&(t.load(),e=t.getState()),e==vt.LOADED}renderIfReadyAndVisible(){const t=this.getLayer();t&&t.getVisible()&&t.getSourceState()==="ready"&&t.changed()}renderDeferred(t){}disposeInternal(){delete this.layer_,super.disposeInternal()}};var sr=ir;let wt=null;function rr(){wt=at(1,1,void 0,{willReadFrequently:!0})}let or=class extends sr{constructor(t){super(t),this.container=null,this.renderedResolution,this.tempTransform=Jt(),this.pixelTransform=Jt(),this.inversePixelTransform=Jt(),this.context=null,this.deferredContext_=null,this.containerReused=!1,this.frameState=null}getImageData(t,e,n){wt||rr(),wt.clearRect(0,0,1,1);let s;try{wt.drawImage(t,e,n,1,1,0,0,1,1),s=wt.getImageData(0,0,1,1).data}catch{return wt=null,null}return s}getBackground(t){let e=this.getLayer().getBackground();return typeof e=="function"&&(e=e(t.viewState.resolution)),e||void 0}useContainer(t,e,n){const s=this.getLayer().getClassName();let r,o;if(t&&t.className===s&&(!n||t&&t.style.backgroundColor&&He(Dn(t.style.backgroundColor),Dn(n)))){const a=t.firstElementChild;a instanceof HTMLCanvasElement&&(o=a.getContext("2d"))}if(o&&As(o.canvas.style.transform,e)?(this.container=t,this.context=o,this.containerReused=!0):this.containerReused?(this.container=null,this.context=null,this.containerReused=!1):this.container&&(this.container.style.backgroundColor=null),!this.container){r=document.createElement("div"),r.className=s;let a=r.style;a.position="absolute",a.width="100%",a.height="100%",o=at();const h=o.canvas;r.appendChild(h),a=h.style,a.position="absolute",a.left="0",a.transformOrigin="top left",this.container=r,this.context=o}!this.containerReused&&n&&!this.container.style.backgroundColor&&(this.container.style.backgroundColor=n)}clipUnrotated(t,e,n){const s=bt(n),r=Re(n),o=pe(n),a=me(n);V(e.coordinateToPixelTransform,s),V(e.coordinateToPixelTransform,r),V(e.coordinateToPixelTransform,o),V(e.coordinateToPixelTransform,a);const h=this.inversePixelTransform;V(h,s),V(h,r),V(h,o),V(h,a),t.save(),t.beginPath(),t.moveTo(Math.round(s[0]),Math.round(s[1])),t.lineTo(Math.round(r[0]),Math.round(r[1])),t.lineTo(Math.round(o[0]),Math.round(o[1])),t.lineTo(Math.round(a[0]),Math.round(a[1])),t.clip()}prepareContainer(t,e){const n=t.extent,s=t.viewState.resolution,r=t.viewState.rotation,o=t.pixelRatio,a=Math.round(A(n)/s*o),h=Math.round(U(n)/s*o);te(this.pixelTransform,t.size[0]/2,t.size[1]/2,1/o,1/o,r,-a/2,-h/2),$s(this.inversePixelTransform,this.pixelTransform);const u=Os(this.pixelTransform);if(this.useContainer(e,u,this.getBackground(t)),!this.containerReused){const l=this.context.canvas;l.width!=a||l.height!=h?(l.width=a,l.height=h):this.context.clearRect(0,0,a,h),u!==l.style.transform&&(l.style.transform=u)}}dispatchRenderEvent_(t,e,n){const s=this.getLayer();if(s.hasListener(t)){const r=new Qs(t,this.inversePixelTransform,n,e);s.dispatchEvent(r)}}preRender(t,e){this.frameState=e,!e.declutter&&this.dispatchRenderEvent_(Xt.PRERENDER,t,e)}postRender(t,e){e.declutter||this.dispatchRenderEvent_(Xt.POSTRENDER,t,e)}renderDeferredInternal(t){}getRenderContext(t){return t.declutter&&!this.deferredContext_&&(this.deferredContext_=new tr),t.declutter?this.deferredContext_.getContext():this.context}renderDeferred(t){t.declutter&&(this.dispatchRenderEvent_(Xt.PRERENDER,this.context,t),t.declutter&&this.deferredContext_&&(this.deferredContext_.draw(this.context),this.deferredContext_.clear()),this.renderDeferredInternal(t),this.dispatchRenderEvent_(Xt.POSTRENDER,this.context,t))}getRenderTransform(t,e,n,s,r,o,a){const h=r/2,u=o/2,l=s/e,c=-l,d=-t[0]+a,f=-t[1];return te(this.tempTransform,h,u,l,c,-n,d,f)}disposeInternal(){delete this.frameState,super.disposeInternal()}};var ar=or;function Ne(i,t,e,n){return`${i},${Ys(t,e,n)}`}function Le(i,t,e){if(!(e in i))return i[e]=new Set([t]),!0;const n=i[e],s=n.has(t);return s||n.add(t),!s}function hr(i,t,e){const n=i[e];return n?n.delete(t):!1}function Zn(i,t){const e=i.layerStatesArray[i.layerIndex];e.extent&&(t=yt(t,Rt(e.extent,i.viewState.projection)));const n=e.layer.getRenderSource();if(!n.getWrapX()){const s=n.getTileGridForProjection(i.viewState.projection).getExtent();s&&(t=yt(t,s))}return t}class lr extends ar{constructor(t,e){super(t),e=e||{},this.extentChanged=!0,this.renderComplete=!1,this.renderedExtent_=null,this.renderedPixelRatio,this.renderedProjection=null,this.renderedRevision_,this.renderedTiles=[],this.renderedSourceKey_,this.renderedSourceRevision_,this.tempExtent=_t(),this.tempTileRange_=new wi(0,0,0,0),this.tempTileCoord_=Ln(0,0,0);const n=e.cacheSize!==void 0?e.cacheSize:512;this.tileCache_=new js(n),this.maxStaleKeys=n*.5}getTileCache(){return this.tileCache_}getOrCreateTile(t,e,n,s){const r=this.tileCache_,o=this.getLayer().getSource(),a=Ne(o.getKey(),t,e,n);let h;if(r.containsKey(a))h=r.get(a);else{if(h=o.getTile(t,e,n,s.pixelRatio,s.viewState.projection),!h)return null;r.set(a,h)}return h}getTile(t,e,n,s){return this.getOrCreateTile(t,e,n,s)||null}getData(t){const e=this.frameState;if(!e)return null;const n=this.getLayer(),s=V(e.pixelToCoordinateTransform,t.slice()),r=n.getExtent();if(r&&!sn(r,s))return null;const o=e.viewState,a=n.getRenderSource(),h=a.getTileGridForProjection(o.projection),u=a.getTilePixelRatio(e.pixelRatio);for(let l=h.getZForResolution(o.resolution);l>=h.getMinZoom();--l){const c=h.getTileCoordForCoordAndZ(s,l),d=this.getTile(l,c[1],c[2],e);if(!d||d.getState()!==y.LOADED)continue;const f=h.getOrigin(l),g=Zs(h.getTileSize(l)),_=h.getResolution(l);let m;if(d instanceof Si||d instanceof Gs)m=d.getImage();else if(d instanceof tn){if(m=de(d.getData()),!m)continue}else continue;const x=Math.floor(u*((s[0]-f[0])/_-c[1]*g[0])),p=Math.floor(u*((f[1]-s[1])/_-c[2]*g[1])),E=Math.round(u*a.getGutterForProjection(o.projection));return this.getImageData(m,x+E,p+E)}return null}prepareFrame(t){this.renderedProjection?t.viewState.projection!==this.renderedProjection&&(this.tileCache_.clear(),this.renderedProjection=t.viewState.projection):this.renderedProjection=t.viewState.projection;const e=this.getLayer().getSource();if(!e)return!1;const n=e.getRevision();return this.renderedRevision_?this.renderedRevision_!==n&&(this.renderedRevision_=n,this.renderedSourceKey_===e.getKey()&&this.tileCache_.clear()):this.renderedRevision_=n,!0}enqueueTiles(t,e,n,s,r){const o=t.viewState,a=this.getLayer(),h=a.getRenderSource(),u=h.getTileGridForProjection(o.projection),l=dt(h);l in t.wantedTiles||(t.wantedTiles[l]={});const c=t.wantedTiles[l],d=a.getMapInternal(),f=Math.max(n-r,u.getMinZoom(),u.getZForResolution(Math.min(a.getMaxResolution(),d?d.getView().getResolutionForZoom(Math.max(a.getMinZoom(),0)):u.getResolution(0)),h.zDirection)),g=o.rotation,_=g?ln(o.center,o.resolution,g,t.size):void 0;for(let m=n;m>=f;--m){const x=u.getTileRangeForExtentAndZ(e,m,this.tempTileRange_),p=u.getResolution(m);for(let E=x.minX;E<=x.maxX;++E)for(let v=x.minY;v<=x.maxY;++v){if(g&&!u.tileCoordIntersectsViewport([m,E,v],_))continue;const R=this.getTile(m,E,v,t);if(!R||!Le(s,R,m))continue;const T=R.getKey();if(c[T]=!0,R.getState()===y.IDLE&&!t.tileQueue.isKeyQueued(T)){const $=Ln(m,E,v,this.tempTileCoord_);t.tileQueue.enqueue([R,l,u.getTileCoordCenter($),p])}}}}findStaleTile_(t,e){const n=this.tileCache_,s=t[0],r=t[1],o=t[2],a=this.getStaleKeys();for(let h=0;h<a.length;++h){const u=Ne(a[h],s,r,o);if(n.containsKey(u)){const l=n.peek(u);if(l.getState()===y.LOADED)return l.endTransition(dt(this)),Le(e,l,s),!0}}return!1}findAltTiles_(t,e,n,s){const r=t.getTileRangeForTileCoordAndZ(e,n,this.tempTileRange_);if(!r)return!1;let o=!0;const a=this.tileCache_,h=this.getLayer().getRenderSource().getKey();for(let u=r.minX;u<=r.maxX;++u)for(let l=r.minY;l<=r.maxY;++l){const c=Ne(h,n,u,l);let d=!1;if(a.containsKey(c)){const f=a.peek(c);f.getState()===y.LOADED&&(Le(s,f,n),d=!0)}d||(o=!1)}return o}renderFrame(t,e){this.renderComplete=!0;const n=t.layerStatesArray[t.layerIndex],s=t.viewState,r=s.projection,o=s.resolution,a=s.center,h=t.pixelRatio,u=this.getLayer(),l=u.getSource(),c=l.getTileGridForProjection(r),d=c.getZForResolution(o,l.zDirection),f=c.getResolution(d),g=l.getKey();this.renderedSourceKey_?this.renderedSourceKey_!==g&&(this.prependStaleKey(this.renderedSourceKey_),this.renderedSourceKey_=g):this.renderedSourceKey_=g;let _=t.extent;const m=l.getTilePixelRatio(h);this.prepareContainer(t,e);const x=this.context.canvas.width,p=this.context.canvas.height,E=n.extent&&Rt(n.extent);E&&(_=yt(_,Rt(n.extent)));const v=f*x/2/m,R=f*p/2/m,T=[a[0]-v,a[1]-R,a[0]+v,a[1]+R],$={};this.renderedTiles.length=0;const I=u.getPreload();if(t.nextExtent){const w=c.getZForResolution(s.nextResolution,l.zDirection),P=Zn(t,t.nextExtent);this.enqueueTiles(t,P,w,$,I)}const S=Zn(t,_);if(this.enqueueTiles(t,S,d,$,0),I>0&&setTimeout(()=>{this.enqueueTiles(t,S,d-1,$,I-1)},0),!(d in $))return this.container;const D=dt(this),G=t.time;for(const w of $[d]){const P=w.getState();if(P===y.EMPTY)continue;const j=w.tileCoord;if(P===y.LOADED&&w.getAlpha(D,G)===1){w.endTransition(D);continue}if(P!==y.ERROR&&(this.renderComplete=!1),this.findStaleTile_(j,$)){hr($,w,d),t.animate=!0;continue}if(this.findAltTiles_(c,j,d+1,$))continue;const H=c.getMinZoom();for(let X=d-1;X>=H&&!this.findAltTiles_(c,j,X,$);--X);}const b=f/o*h/m,C=this.getRenderContext(t);te(this.tempTransform,x/2,p/2,b,b,0,-x/2,-p/2),n.extent&&this.clipUnrotated(C,t,E),l.getInterpolate()||(C.imageSmoothingEnabled=!1),this.preRender(C,t);const Z=Object.keys($).map(Number);Z.sort(Ve);let N;const J=[],et=[];for(let w=Z.length-1;w>=0;--w){const P=Z[w],j=l.getTilePixelSize(P,h,r),H=c.getResolution(P)/f,X=j[0]*H*b,nt=j[1]*H*b,Ot=c.getTileCoordForCoordAndZ(bt(T),P),it=c.getTileCoordExtent(Ot),B=V(this.tempTransform,[m*(it[0]-T[0])/f,m*(T[3]-it[3])/f]),K=m*l.getGutterForProjection(r);for(const k of $[P]){if(k.getState()!==y.LOADED)continue;const At=k.tileCoord,Q=Ot[1]-At[1],ri=Math.round(B[0]-(Q-1)*X),We=Ot[2]-At[2],oi=Math.round(B[1]-(We-1)*nt),st=Math.round(B[0]-Q*X),rt=Math.round(B[1]-We*nt),jt=ri-st,Yt=oi-rt,Ke=Z.length===1;let oe=!1;N=[st,rt,st+jt,rt,st+jt,rt+Yt,st,rt+Yt];for(let zt=0,ai=J.length;zt<ai;++zt)if(!Ke&&P<et[zt]){const Y=J[zt];Nt([st,rt,st+jt,rt+Yt],[Y[0],Y[3],Y[4],Y[7]])&&(oe||(C.save(),oe=!0),C.beginPath(),C.moveTo(N[0],N[1]),C.lineTo(N[2],N[3]),C.lineTo(N[4],N[5]),C.lineTo(N[6],N[7]),C.moveTo(Y[6],Y[7]),C.lineTo(Y[4],Y[5]),C.lineTo(Y[2],Y[3]),C.lineTo(Y[0],Y[1]),C.clip())}J.push(N),et.push(P),this.drawTile(k,t,st,rt,jt,Yt,K,Ke),oe&&C.restore(),this.renderedTiles.unshift(k),this.updateUsedTiles(t.usedTiles,l,k)}}if(this.renderedResolution=f,this.extentChanged=!this.renderedExtent_||!Ai(this.renderedExtent_,T),this.renderedExtent_=T,this.renderedPixelRatio=h,this.postRender(this.context,t),n.extent&&C.restore(),C.imageSmoothingEnabled=!0,this.renderComplete){const w=(P,j)=>{const H=dt(l),X=j.wantedTiles[H],nt=X?Object.keys(X).length:0;this.updateCacheSize(nt),this.tileCache_.expireCache()};t.postRenderFunctions.push(w)}return this.container}updateCacheSize(t){this.tileCache_.highWaterMark=Math.max(this.tileCache_.highWaterMark,t*2)}drawTile(t,e,n,s,r,o,a,h){let u;if(t instanceof tn){if(u=de(t.getData()),!u)throw new Error("Rendering array data is not yet supported")}else u=this.getTileImage(t);if(!u)return;const l=this.getRenderContext(e),c=dt(this),d=e.layerStatesArray[e.layerIndex],f=d.opacity*(h?t.getAlpha(c,e.time):1),g=f!==l.globalAlpha;g&&(l.save(),l.globalAlpha=f),l.drawImage(u,a,a,u.width-2*a,u.height-2*a,n,s,r,o),g&&l.restore(),f!==d.opacity?e.animate=!0:h&&t.endTransition(c)}getImage(){const t=this.context;return t?t.canvas:null}getTileImage(t){return t.getImage()}updateUsedTiles(t,e,n){const s=dt(e);s in t||(t[s]={}),t[s][n.getKey()]=!0}}var ur=lr,cr={PROPERTYCHANGE:"propertychange"};let Xn=class extends he{constructor(t,e,n){super(t),this.key=e,this.oldValue=n}},dr=class extends Gn{constructor(t){super(),this.on,this.once,this.un,dt(this),this.values_=null,t!==void 0&&this.setProperties(t)}get(t){let e;return this.values_&&this.values_.hasOwnProperty(t)&&(e=this.values_[t]),e}getKeys(){return this.values_&&Object.keys(this.values_)||[]}getProperties(){return this.values_&&Object.assign({},this.values_)||{}}getPropertiesInternal(){return this.values_}hasProperties(){return!!this.values_}notify(t,e){let n;n=`change:${t}`,this.hasListener(n)&&this.dispatchEvent(new Xn(n,t,e)),n=cr.PROPERTYCHANGE,this.hasListener(n)&&this.dispatchEvent(new Xn(n,t,e))}addChangeListener(t,e){this.addEventListener(`change:${t}`,e)}removeChangeListener(t,e){this.removeEventListener(`change:${t}`,e)}set(t,e,n){const s=this.values_||(this.values_={});if(n)s[t]=e;else{const r=s[t];s[t]=e,r!==e&&this.notify(t,r)}}setProperties(t,e){for(const n in t)this.set(n,t[n],e)}applyProperties(t){t.values_&&Object.assign(this.values_||(this.values_={}),t.values_)}unset(t,e){if(this.values_&&t in this.values_){const n=this.values_[t];delete this.values_[t],gi(this.values_)&&(this.values_=null),e||this.notify(t,n)}}};var Fe=dr,ct={ANIMATING:0,INTERACTING:1},q={CENTER:"center",RESOLUTION:"resolution",ROTATION:"rotation"};function jn(i,t,e){return function(n,s,r,o,a){if(!n)return;if(!s&&!t)return n;const h=t?0:r[0]*s,u=t?0:r[1]*s,l=a?a[0]:0,c=a?a[1]:0;let d=i[0]+h/2+l,f=i[2]-h/2+l,g=i[1]+u/2+c,_=i[3]-u/2+c;d>f&&(d=(f+d)/2,f=d),g>_&&(g=(_+g)/2,_=g);let m=F(n[0],d,f),x=F(n[1],g,_);if(o&&e&&s){const p=30*s;m+=-p*Math.log(1+Math.max(0,d-n[0])/p)+p*Math.log(1+Math.max(0,n[0]-f)/p),x+=-p*Math.log(1+Math.max(0,g-n[1])/p)+p*Math.log(1+Math.max(0,n[1]-_)/p)}return[m,x]}}function gr(i){return i}function fr(i,t,e,n,s,r,o){r=r||[],o=o||2;let a=0;for(let h=t;h<e;h+=n){const u=i[h],l=i[h+1];r[a++]=s[0]*u+s[2]*l+s[4],r[a++]=s[1]*u+s[3]*l+s[5];for(let c=2;c<o;c++)r[a++]=i[h+c]}return r&&r.length!=a&&(r.length=a),r}function _r(i,t,e,n,s,r,o){o=o||[];const a=Math.cos(s),h=Math.sin(s),u=r[0],l=r[1];let c=0;for(let d=t;d<e;d+=n){const f=i[d]-u,g=i[d+1]-l;o[c++]=u+f*a-g*h,o[c++]=l+f*h+g*a;for(let _=d+2;_<d+n;++_)o[c++]=i[_]}return o&&o.length!=c&&(o.length=c),o}function mr(i,t,e,n,s,r,o,a){a=a||[];const h=o[0],u=o[1];let l=0;for(let c=t;c<e;c+=n){const d=i[c]-h,f=i[c+1]-u;a[l++]=h+s*d,a[l++]=u+r*f;for(let g=c+2;g<c+n;++g)a[l++]=i[g]}return a&&a.length!=l&&(a.length=l),a}function pr(i,t,e,n,s,r,o){o=o||[];let a=0;for(let h=t;h<e;h+=n){o[a++]=i[h]+s,o[a++]=i[h+1]+r;for(let u=h+2;u<h+n;++u)o[a++]=i[u]}return o&&o.length!=a&&(o.length=a),o}const Yn=Jt(),Rr=[NaN,NaN];let xr=class extends Fe{constructor(){super(),this.extent_=_t(),this.extentRevision_=-1,this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=0,this.simplifyTransformedInternal=di((t,e,n)=>{if(!n)return this.getSimplifiedGeometry(e);const s=this.clone();return s.applyTransform(n),s.getSimplifiedGeometry(e)})}simplifyTransformed(t,e){return this.simplifyTransformedInternal(this.getRevision(),t,e)}clone(){return O()}closestPointXY(t,e,n,s){return O()}containsXY(t,e){return this.closestPointXY(t,e,Rr,Number.MIN_VALUE)===0}getClosestPoint(t,e){return e=e||[NaN,NaN],this.closestPointXY(t[0],t[1],e,1/0),e}intersectsCoordinate(t){return this.containsXY(t[0],t[1])}computeExtent(t){return O()}getExtent(t){if(this.extentRevision_!=this.getRevision()){const e=this.computeExtent(this.extent_);(isNaN(e[0])||isNaN(e[1]))&&fe(e),this.extentRevision_=this.getRevision()}return Fi(this.extent_,t)}rotate(t,e){O()}scale(t,e,n){O()}simplify(t){return this.getSimplifiedGeometry(t*t)}getSimplifiedGeometry(t){return O()}getType(){return O()}applyTransform(t){O()}intersectsExtent(t){return O()}translate(t,e){O()}transform(t,e){const n=tt(t),s=n.getUnits()=="tile-pixels"?function(r,o,a){const h=n.getExtent(),u=n.getWorldExtent(),l=U(u)/U(h);te(Yn,u[0],u[3],l,-l,0,0,0);const c=fr(r,0,r.length,a,Yn,o),d=Qt(n,e);return d?d(c,c,a):c}:Qt(n,e);return this.applyTransform(s),this}};var vr=xr;class Er extends vr{constructor(){super(),this.layout="XY",this.stride=2,this.flatCoordinates}computeExtent(t){return Oi(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t)}getCoordinates(){return O()}getFirstCoordinate(){return this.flatCoordinates.slice(0,this.stride)}getFlatCoordinates(){return this.flatCoordinates}getLastCoordinate(){return this.flatCoordinates.slice(this.flatCoordinates.length-this.stride)}getLayout(){return this.layout}getSimplifiedGeometry(t){if(this.simplifiedGeometryRevision!==this.getRevision()&&(this.simplifiedGeometryMaxMinSquaredTolerance=0,this.simplifiedGeometryRevision=this.getRevision()),t<0||this.simplifiedGeometryMaxMinSquaredTolerance!==0&&t<=this.simplifiedGeometryMaxMinSquaredTolerance)return this;const e=this.getSimplifiedGeometryInternal(t);return e.getFlatCoordinates().length<this.flatCoordinates.length?e:(this.simplifiedGeometryMaxMinSquaredTolerance=t,this)}getSimplifiedGeometryInternal(t){return this}getStride(){return this.stride}setFlatCoordinates(t,e){this.stride=zn(t),this.layout=t,this.flatCoordinates=e}setCoordinates(t,e){O()}setLayout(t,e,n){let s;if(t)s=zn(t);else{for(let r=0;r<n;++r){if(e.length===0){this.layout="XY",this.stride=2;return}e=e[0]}s=e.length,t=yr(s)}this.layout=t,this.stride=s}applyTransform(t){this.flatCoordinates&&(t(this.flatCoordinates,this.flatCoordinates,this.layout.startsWith("XYZ")?3:2,this.stride),this.changed())}rotate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();_r(n,0,n.length,s,t,e,n),this.changed()}}scale(t,e,n){e===void 0&&(e=t),n||(n=Et(this.getExtent()));const s=this.getFlatCoordinates();if(s){const r=this.getStride();mr(s,0,s.length,r,t,e,n,s),this.changed()}}translate(t,e){const n=this.getFlatCoordinates();if(n){const s=this.getStride();pr(n,0,n.length,s,t,e,n),this.changed()}}}function yr(i){let t;return i==2?t="XY":i==3?t="XYZ":i==4&&(t="XYZM"),t}function zn(i){let t;return i=="XY"?t=2:i=="XYZ"||i=="XYM"?t=3:i=="XYZM"&&(t=4),t}var De=Er;function Wn(i,t,e,n){let s=0;const r=i[e-n],o=i[e-n+1];let a=0,h=0;for(;t<e;t+=n){const u=i[t]-r,l=i[t+1]-o;s+=h*u-a*l,a=u,h=l}return s/2}function Cr(i,t,e,n){let s=0;for(let r=0,o=e.length;r<o;++r){const a=e[r];s+=Wn(i,t,a,n),t=a}return s}function Kn(i,t,e,n,s,r,o){const a=i[t],h=i[t+1],u=i[e]-a,l=i[e+1]-h;let c;if(u===0&&l===0)c=t;else{const d=((s-a)*u+(r-h)*l)/(u*u+l*l);if(d>1)c=e;else if(d>0){for(let f=0;f<n;++f)o[f]=zi(i[t+f],i[e+f],d);o.length=n;return}else c=t}for(let d=0;d<n;++d)o[d]=i[c+d];o.length=n}function kn(i,t,e,n,s){let r=i[t],o=i[t+1];for(t+=n;t<e;t+=n){const a=i[t],h=i[t+1],u=Ct(r,o,a,h);u>s&&(s=u),r=a,o=h}return s}function Mr(i,t,e,n,s){for(let r=0,o=e.length;r<o;++r){const a=e[r];s=kn(i,t,a,n,s),t=a}return s}function Un(i,t,e,n,s,r,o,a,h,u,l){if(t==e)return u;let c,d;if(s===0){if(d=Ct(o,a,i[t],i[t+1]),d<u){for(c=0;c<n;++c)h[c]=i[t+c];return h.length=n,d}return u}l=l||[NaN,NaN];let f=t+n;for(;f<e;)if(Kn(i,f-n,f,n,o,a,l),d=Ct(o,a,l[0],l[1]),d<u){for(u=d,c=0;c<n;++c)h[c]=l[c];h.length=n,f+=n}else f+=n*Math.max((Math.sqrt(d)-Math.sqrt(u))/s|0,1);if(Kn(i,e-n,t,n,o,a,l),d=Ct(o,a,l[0],l[1]),d<u){for(u=d,c=0;c<n;++c)h[c]=l[c];h.length=n}return u}function Ir(i,t,e,n,s,r,o,a,h,u,l){l=l||[NaN,NaN];for(let c=0,d=e.length;c<d;++c){const f=e[c];u=Un(i,t,f,n,s,r,o,a,h,u,l),t=f}return u}function Tr(i,t,e,n){for(let s=0,r=e.length;s<r;++s)i[t++]=e[s];return t}function Vn(i,t,e,n){for(let s=0,r=e.length;s<r;++s){const o=e[s];for(let a=0;a<n;++a)i[t++]=o[a]}return t}function Sr(i,t,e,n,s){s=s||[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=Vn(i,t,e[o],n);s[r++]=h,t=h}return s.length=r,s}function qn(i,t,e,n,s){s=s!==void 0?s:[];let r=0;for(let o=t;o<e;o+=n)s[r++]=i.slice(o,o+n);return s.length=r,s}function $r(i,t,e,n,s){s=s!==void 0?s:[];let r=0;for(let o=0,a=e.length;o<a;++o){const h=e[o];s[r++]=qn(i,t,h,n,s[r]),t=h}return s.length=r,s}function wr(i,t,e,n,s,r,o){const a=(e-t)/n;if(a<3){for(;t<e;t+=n)r[o++]=i[t],r[o++]=i[t+1];return o}const h=new Array(a);h[0]=1,h[a-1]=1;const u=[t,e-n];let l=0;for(;u.length>0;){const c=u.pop(),d=u.pop();let f=0;const g=i[d],_=i[d+1],m=i[c],x=i[c+1];for(let p=d+n;p<c;p+=n){const E=i[p],v=i[p+1],R=ji(E,v,g,_,m,x);R>f&&(l=p,f=R)}f>s&&(h[(l-t)/n]=1,d+n<l&&u.push(d,l),l+n<c&&u.push(l,c))}for(let c=0;c<a;++c)h[c]&&(r[o++]=i[t+c*n],r[o++]=i[t+c*n+1]);return o}function Pt(i,t){return t*Math.round(i/t)}function Pr(i,t,e,n,s,r,o){if(t==e)return o;let a=Pt(i[t],s),h=Pt(i[t+1],s);t+=n,r[o++]=a,r[o++]=h;let u,l;do if(u=Pt(i[t],s),l=Pt(i[t+1],s),t+=n,t==e)return r[o++]=u,r[o++]=l,o;while(u==a&&l==h);for(;t<e;){const c=Pt(i[t],s),d=Pt(i[t+1],s);if(t+=n,c==u&&d==l)continue;const f=u-a,g=l-h,_=c-a,m=d-h;if(f*m==g*_&&(f<0&&_<f||f==_||f>0&&_>f)&&(g<0&&m<g||g==m||g>0&&m>g)){u=c,l=d;continue}r[o++]=u,r[o++]=l,a=u,h=l,u=c,l=d}return r[o++]=u,r[o++]=l,o}function Or(i,t,e,n,s,r,o,a){for(let h=0,u=e.length;h<u;++h){const l=e[h];o=Pr(i,t,l,n,s,r,o),a.push(o),t=l}return o}let Ar=class Ye extends De{constructor(t,e){super(),this.maxDelta_=-1,this.maxDeltaRevision_=-1,e!==void 0&&!Array.isArray(t[0])?this.setFlatCoordinates(e,t):this.setCoordinates(t,e)}clone(){return new Ye(this.flatCoordinates.slice(),this.layout)}closestPointXY(t,e,n,s){return s<nn(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(kn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Un(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,this.maxDelta_,!0,t,e,n,s))}getArea(){return Wn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getCoordinates(){return qn(this.flatCoordinates,0,this.flatCoordinates.length,this.stride)}getSimplifiedGeometryInternal(t){const e=[];return e.length=wr(this.flatCoordinates,0,this.flatCoordinates.length,this.stride,t,e,0),new Ye(e,"XY")}getType(){return"LinearRing"}intersectsExtent(t){return!1}setCoordinates(t,e){this.setLayout(e,t,1),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Vn(this.flatCoordinates,0,t,this.stride),this.changed()}};var Hn=Ar;class ze extends De{constructor(t,e){super(),this.setCoordinates(t,e)}clone(){const t=new ze(this.flatCoordinates.slice(),this.layout);return t.applyProperties(this),t}closestPointXY(t,e,n,s){const r=this.flatCoordinates,o=Ct(t,e,r[0],r[1]);if(o<s){const a=this.stride;for(let h=0;h<a;++h)n[h]=r[h];return n.length=a,o}return s}getCoordinates(){return this.flatCoordinates.slice()}computeExtent(t){return Pi(this.flatCoordinates,t)}getType(){return"Point"}intersectsExtent(t){return rn(t,this.flatCoordinates[0],this.flatCoordinates[1])}setCoordinates(t,e){this.setLayout(e,t,0),this.flatCoordinates||(this.flatCoordinates=[]),this.flatCoordinates.length=Tr(this.flatCoordinates,0,t,this.stride),this.changed()}}var br=ze;function Nr(i,t,e,n,s){return!hn(s,function(r){return!xt(i,t,e,n,r[0],r[1])})}function xt(i,t,e,n,s,r){let o=0,a=i[e-n],h=i[e-n+1];for(;t<e;t+=n){const u=i[t],l=i[t+1];h<=r?l>r&&(u-a)*(r-h)-(s-a)*(l-h)>0&&o++:l<=r&&(u-a)*(r-h)-(s-a)*(l-h)<0&&o--,a=u,h=l}return o!==0}function Bn(i,t,e,n,s,r){if(e.length===0||!xt(i,t,e[0],n,s,r))return!1;for(let o=1,a=e.length;o<a;++o)if(xt(i,e[o-1],e[o],n,s,r))return!1;return!0}function Lr(i,t,e,n,s,r,o){let a,h,u,l,c,d,f;const g=s[r+1],_=[];for(let p=0,E=e.length;p<E;++p){const v=e[p];for(l=i[v-n],d=i[v-n+1],a=t;a<v;a+=n)c=i[a],f=i[a+1],(g<=d&&f<=g||d<=g&&g<=f)&&(u=(g-d)/(f-d)*(c-l)+l,_.push(u)),l=c,d=f}let m=NaN,x=-1/0;for(_.sort(Ve),l=_[0],a=1,h=_.length;a<h;++a){c=_[a];const p=Math.abs(c-l);p>x&&(u=(l+c)/2,Bn(i,t,e,n,u,g)&&(m=u,x=p)),l=c}return isNaN(m)&&(m=s[r]),o?(o.push(m,g,x),o):[m,g,x]}function Fr(i,t,e,n,s){let r;for(t+=n;t<e;t+=n)if(r=s(i.slice(t-n,t),i.slice(t,t+n)),r)return r;return!1}function Qn(i,t,e,n,s,r){return r=r??an(_t(),i,t,e,n),Nt(s,r)?r[0]>=s[0]&&r[2]<=s[2]||r[1]>=s[1]&&r[3]<=s[3]?!0:Fr(i,t,e,n,function(o,a){return Di(s,o,a)}):!1}function Dr(i,t,e,n,s){return!!(Qn(i,t,e,n,s)||xt(i,t,e,n,s[0],s[1])||xt(i,t,e,n,s[0],s[3])||xt(i,t,e,n,s[2],s[1])||xt(i,t,e,n,s[2],s[3]))}function Gr(i,t,e,n,s){if(!Dr(i,t,e[0],n,s))return!1;if(e.length===1)return!0;for(let r=1,o=e.length;r<o;++r)if(Nr(i,e[r-1],e[r],n,s)&&!Qn(i,e[r-1],e[r],n,s))return!1;return!0}function Zr(i,t,e,n){for(;t<e-n;){for(let s=0;s<n;++s){const r=i[t+s];i[t+s]=i[e-n+s],i[e-n+s]=r}t+=n,e-=n}}function Jn(i,t,e,n){let s=0,r=i[e-n],o=i[e-n+1];for(;t<e;t+=n){const a=i[t],h=i[t+1];s+=(a-r)*(h+o),r=a,o=h}return s===0?void 0:s>0}function Xr(i,t,e,n,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],h=Jn(i,t,a,n);if(r===0){if(s&&h||!s&&!h)return!1}else if(s&&!h||!s&&h)return!1;t=a}return!0}function ti(i,t,e,n,s){s=s!==void 0?s:!1;for(let r=0,o=e.length;r<o;++r){const a=e[r],h=Jn(i,t,a,n);(r===0?s&&h||!s&&!h:s&&!h||!s&&h)&&Zr(i,t,a,n),t=a}return t}class re extends De{constructor(t,e,n){super(),this.ends_=[],this.flatInteriorPointRevision_=-1,this.flatInteriorPoint_=null,this.maxDelta_=-1,this.maxDeltaRevision_=-1,this.orientedRevision_=-1,this.orientedFlatCoordinates_=null,e!==void 0&&n?(this.setFlatCoordinates(e,t),this.ends_=n):this.setCoordinates(t,e)}appendLinearRing(t){this.flatCoordinates?ci(this.flatCoordinates,t.getFlatCoordinates()):this.flatCoordinates=t.getFlatCoordinates().slice(),this.ends_.push(this.flatCoordinates.length),this.changed()}clone(){const t=new re(this.flatCoordinates.slice(),this.layout,this.ends_.slice());return t.applyProperties(this),t}closestPointXY(t,e,n,s){return s<nn(this.getExtent(),t,e)?s:(this.maxDeltaRevision_!=this.getRevision()&&(this.maxDelta_=Math.sqrt(Mr(this.flatCoordinates,0,this.ends_,this.stride,0)),this.maxDeltaRevision_=this.getRevision()),Ir(this.flatCoordinates,0,this.ends_,this.stride,this.maxDelta_,!0,t,e,n,s))}containsXY(t,e){return Bn(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,e)}getArea(){return Cr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride)}getCoordinates(t){let e;return t!==void 0?(e=this.getOrientedFlatCoordinates().slice(),ti(e,0,this.ends_,this.stride,t)):e=this.flatCoordinates,$r(e,0,this.ends_,this.stride)}getEnds(){return this.ends_}getFlatInteriorPoint(){if(this.flatInteriorPointRevision_!=this.getRevision()){const t=Et(this.getExtent());this.flatInteriorPoint_=Lr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t,0),this.flatInteriorPointRevision_=this.getRevision()}return this.flatInteriorPoint_}getInteriorPoint(){return new br(this.getFlatInteriorPoint(),"XYM")}getLinearRingCount(){return this.ends_.length}getLinearRing(t){return t<0||this.ends_.length<=t?null:new Hn(this.flatCoordinates.slice(t===0?0:this.ends_[t-1],this.ends_[t]),this.layout)}getLinearRings(){const t=this.layout,e=this.flatCoordinates,n=this.ends_,s=[];let r=0;for(let o=0,a=n.length;o<a;++o){const h=n[o],u=new Hn(e.slice(r,h),t);s.push(u),r=h}return s}getOrientedFlatCoordinates(){if(this.orientedRevision_!=this.getRevision()){const t=this.flatCoordinates;Xr(t,0,this.ends_,this.stride)?this.orientedFlatCoordinates_=t:(this.orientedFlatCoordinates_=t.slice(),this.orientedFlatCoordinates_.length=ti(this.orientedFlatCoordinates_,0,this.ends_,this.stride)),this.orientedRevision_=this.getRevision()}return this.orientedFlatCoordinates_}getSimplifiedGeometryInternal(t){const e=[],n=[];return e.length=Or(this.flatCoordinates,0,this.ends_,this.stride,Math.sqrt(t),e,0,n),new re(e,"XY",n)}getType(){return"Polygon"}intersectsExtent(t){return Gr(this.getOrientedFlatCoordinates(),0,this.ends_,this.stride,t)}setCoordinates(t,e){this.setLayout(e,t,2),this.flatCoordinates||(this.flatCoordinates=[]);const n=Sr(this.flatCoordinates,0,t,this.stride,this.ends_);this.flatCoordinates.length=n.length===0?0:n[n.length-1],this.changed()}}function ei(i){if(xe(i))throw new Error("Cannot create polygon from empty extent");const t=i[0],e=i[1],n=i[2],s=i[3],r=[t,e,t,s,n,s,n,e,t,e];return new re(r,"XY",[r.length])}function Ge(i,t,e,n){const s=A(t)/e[0],r=U(t)/e[1];return n?Math.min(i,Math.max(s,r)):Math.min(i,Math.min(s,r))}function Ze(i,t,e){let n=Math.min(i,t);const s=50;return n*=Math.log(1+s*Math.max(0,i/t-1))/s+1,e&&(n=Math.max(n,e),n/=Math.log(1+s*Math.max(0,e/i-1))/s+1),F(n,e/2,t*2)}function jr(i,t,e,n){return t=t!==void 0?t:!0,function(s,r,o,a){if(s!==void 0){const h=i[0],u=i[i.length-1],l=e?Ge(h,e,o,n):h;if(a)return t?Ze(s,l,u):F(s,u,l);const c=Math.min(l,s),d=Math.floor(qe(i,c,r));return i[d]>l&&d<i.length-1?i[d+1]:i[d]}}}function Yr(i,t,e,n,s,r){return n=n!==void 0?n:!0,e=e!==void 0?e:0,function(o,a,h,u){if(o!==void 0){const l=s?Ge(t,s,h,r):t;if(u)return n?Ze(o,l,e):F(o,e,l);const c=1e-9,d=Math.ceil(Math.log(t/l)/Math.log(i)-c),f=-a*(.5-c)+.5,g=Math.min(l,o),_=Math.floor(Math.log(t/g)/Math.log(i)+f),m=Math.max(d,_),x=t/Math.pow(i,m);return F(x,e,l)}}}function ni(i,t,e,n,s){return e=e!==void 0?e:!0,function(r,o,a,h){if(r!==void 0){const u=n?Ge(i,n,a,s):i;return!e||!h?F(r,t,u):Ze(r,u,t)}}}function zr(i){if(i!==void 0)return 0}function ii(i){if(i!==void 0)return i}function Wr(i){const t=2*Math.PI/i;return function(e,n){if(n)return e;if(e!==void 0)return e=Math.floor(e/t+.5)*t,e}}function Kr(i){const t=lt(5);return function(e,n){return n||e===void 0?e:Math.abs(e)<=t?0:e}}const kr=256,Xe=0;class Ur extends Fe{constructor(t){super(),this.on,this.once,this.un,t=Object.assign({},t),this.hints_=[0,0],this.animations_=[],this.updateAnimationKey_,this.projection_=$e(t.projection,"EPSG:3857"),this.viewportSize_=[100,100],this.targetCenter_=null,this.targetResolution_,this.targetRotation_,this.nextCenter_=null,this.nextResolution_,this.nextRotation_,this.cancelAnchor_=void 0,t.projection&&xs(),t.center&&(t.center=ut(t.center,this.projection_)),t.extent&&(t.extent=Rt(t.extent,this.projection_)),this.applyOptions_(t)}applyOptions_(t){const e=Object.assign({},t);for(const a in q)delete e[a];this.setProperties(e,!0);const n=qr(t);this.maxResolution_=n.maxResolution,this.minResolution_=n.minResolution,this.zoomFactor_=n.zoomFactor,this.resolutions_=t.resolutions,this.padding_=t.padding,this.minZoom_=n.minZoom;const s=Vr(t),r=n.constraint,o=Hr(t);this.constraints_={center:s,resolution:r,rotation:o},this.setRotation(t.rotation!==void 0?t.rotation:0),this.setCenterInternal(t.center!==void 0?t.center:null),t.resolution!==void 0?this.setResolution(t.resolution):t.zoom!==void 0&&this.setZoom(t.zoom)}get padding(){return this.padding_}set padding(t){let e=this.padding_;this.padding_=t;const n=this.getCenterInternal();if(n){const s=t||[0,0,0,0];e=e||[0,0,0,0];const r=this.getResolution(),o=r/2*(s[3]-e[3]+e[1]-s[1]),a=r/2*(s[0]-e[0]+e[2]-s[2]);this.setCenterInternal([n[0]+o,n[1]-a])}}getUpdatedOptions_(t){const e=this.getProperties();return e.resolution!==void 0?e.resolution=this.getResolution():e.zoom=this.getZoom(),e.center=this.getCenterInternal(),e.rotation=this.getRotation(),Object.assign({},e,t)}animate(t){this.isDef()&&!this.getAnimating()&&this.resolveConstraints(0);const e=new Array(arguments.length);for(let n=0;n<e.length;++n){let s=arguments[n];s.center&&(s=Object.assign({},s),s.center=ut(s.center,this.getProjection())),s.anchor&&(s=Object.assign({},s),s.anchor=ut(s.anchor,this.getProjection())),e[n]=s}this.animateInternal.apply(this,e)}animateInternal(t){let e=arguments.length,n;e>1&&typeof arguments[e-1]=="function"&&(n=arguments[e-1],--e);let s=0;for(;s<e&&!this.isDef();++s){const l=arguments[s];l.center&&this.setCenterInternal(l.center),l.zoom!==void 0?this.setZoom(l.zoom):l.resolution&&this.setResolution(l.resolution),l.rotation!==void 0&&this.setRotation(l.rotation)}if(s===e){n&&ie(n,!0);return}let r=Date.now(),o=this.targetCenter_.slice(),a=this.targetResolution_,h=this.targetRotation_;const u=[];for(;s<e;++s){const l=arguments[s],c={start:r,complete:!1,anchor:l.anchor,duration:l.duration!==void 0?l.duration:1e3,easing:l.easing||li,callback:n};if(l.center&&(c.sourceCenter=o,c.targetCenter=l.center.slice(),o=c.targetCenter),l.zoom!==void 0?(c.sourceResolution=a,c.targetResolution=this.getResolutionForZoom(l.zoom),a=c.targetResolution):l.resolution&&(c.sourceResolution=a,c.targetResolution=l.resolution,a=c.targetResolution),l.rotation!==void 0){c.sourceRotation=h;const d=Lt(l.rotation-h+Math.PI,2*Math.PI)-Math.PI;c.targetRotation=h+d,h=c.targetRotation}Br(c)?c.complete=!0:r+=c.duration,u.push(c)}this.animations_.push(u),this.setHint(ct.ANIMATING,1),this.updateAnimations_()}getAnimating(){return this.hints_[ct.ANIMATING]>0}getInteracting(){return this.hints_[ct.INTERACTING]>0}cancelAnimations(){this.setHint(ct.ANIMATING,-this.hints_[ct.ANIMATING]);let t;for(let e=0,n=this.animations_.length;e<n;++e){const s=this.animations_[e];if(s[0].callback&&ie(s[0].callback,!1),!t)for(let r=0,o=s.length;r<o;++r){const a=s[r];if(!a.complete){t=a.anchor;break}}}this.animations_.length=0,this.cancelAnchor_=t,this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN}updateAnimations_(){if(this.updateAnimationKey_!==void 0&&(cancelAnimationFrame(this.updateAnimationKey_),this.updateAnimationKey_=void 0),!this.getAnimating())return;const t=Date.now();let e=!1;for(let n=this.animations_.length-1;n>=0;--n){const s=this.animations_[n];let r=!0;for(let o=0,a=s.length;o<a;++o){const h=s[o];if(h.complete)continue;const u=t-h.start;let l=h.duration>0?u/h.duration:1;l>=1?(h.complete=!0,l=1):r=!1;const c=h.easing(l);if(h.sourceCenter){const d=h.sourceCenter[0],f=h.sourceCenter[1],g=h.targetCenter[0],_=h.targetCenter[1];this.nextCenter_=h.targetCenter;const m=d+c*(g-d),x=f+c*(_-f);this.targetCenter_=[m,x]}if(h.sourceResolution&&h.targetResolution){const d=c===1?h.targetResolution:h.sourceResolution+c*(h.targetResolution-h.sourceResolution);if(h.anchor){const f=this.getViewportSize_(this.getRotation()),g=this.constraints_.resolution(d,0,f,!0);this.targetCenter_=this.calculateCenterZoom(g,h.anchor)}this.nextResolution_=h.targetResolution,this.targetResolution_=d,this.applyTargetState_(!0)}if(h.sourceRotation!==void 0&&h.targetRotation!==void 0){const d=c===1?Lt(h.targetRotation+Math.PI,2*Math.PI)-Math.PI:h.sourceRotation+c*(h.targetRotation-h.sourceRotation);if(h.anchor){const f=this.constraints_.rotation(d,!0);this.targetCenter_=this.calculateCenterRotate(f,h.anchor)}this.nextRotation_=h.targetRotation,this.targetRotation_=d}if(this.applyTargetState_(!0),e=!0,!h.complete)break}if(r){this.animations_[n]=null,this.setHint(ct.ANIMATING,-1),this.nextCenter_=null,this.nextResolution_=NaN,this.nextRotation_=NaN;const o=s[0].callback;o&&ie(o,!0)}}this.animations_=this.animations_.filter(Boolean),e&&this.updateAnimationKey_===void 0&&(this.updateAnimationKey_=requestAnimationFrame(this.updateAnimations_.bind(this)))}calculateCenterRotate(t,e){let n;const s=this.getCenterInternal();return s!==void 0&&(n=[s[0]-e[0],s[1]-e[1]],ki(n,t-this.getRotation()),Ki(n,e)),n}calculateCenterZoom(t,e){let n;const s=this.getCenterInternal(),r=this.getResolution();if(s!==void 0&&r!==void 0){const o=e[0]-t*(e[0]-s[0])/r,a=e[1]-t*(e[1]-s[1])/r;n=[o,a]}return n}getViewportSize_(t){const e=this.viewportSize_;if(t){const n=e[0],s=e[1];return[Math.abs(n*Math.cos(t))+Math.abs(s*Math.sin(t)),Math.abs(n*Math.sin(t))+Math.abs(s*Math.cos(t))]}return e}setViewportSize(t){this.viewportSize_=Array.isArray(t)?t.slice():[100,100],this.getAnimating()||this.resolveConstraints(0)}getCenter(){const t=this.getCenterInternal();return t&&Pn(t,this.getProjection())}getCenterInternal(){return this.get(q.CENTER)}getConstraints(){return this.constraints_}getConstrainResolution(){return this.get("constrainResolution")}getHints(t){return t!==void 0?(t[0]=this.hints_[0],t[1]=this.hints_[1],t):this.hints_.slice()}calculateExtent(t){const e=this.calculateExtentInternal(t);return Cs(e,this.getProjection())}calculateExtentInternal(t){t=t||this.getViewportSizeMinusPadding_();const e=this.getCenterInternal();W(e,"The view center is not defined");const n=this.getResolution();W(n!==void 0,"The view resolution is not defined");const s=this.getRotation();return W(s!==void 0,"The view rotation is not defined"),Li(e,n,s,t)}getMaxResolution(){return this.maxResolution_}getMinResolution(){return this.minResolution_}getMaxZoom(){return this.getZoomForResolution(this.minResolution_)}setMaxZoom(t){this.applyOptions_(this.getUpdatedOptions_({maxZoom:t}))}getMinZoom(){return this.getZoomForResolution(this.maxResolution_)}setMinZoom(t){this.applyOptions_(this.getUpdatedOptions_({minZoom:t}))}setConstrainResolution(t){this.applyOptions_(this.getUpdatedOptions_({constrainResolution:t}))}getProjection(){return this.projection_}getResolution(){return this.get(q.RESOLUTION)}getResolutions(){return this.resolutions_}getResolutionForExtent(t,e){return this.getResolutionForExtentInternal(Rt(t,this.getProjection()),e)}getResolutionForExtentInternal(t,e){e=e||this.getViewportSizeMinusPadding_();const n=A(t)/e[0],s=U(t)/e[1];return Math.max(n,s)}getResolutionForValueFunction(t){t=t||2;const e=this.getConstrainedResolution(this.maxResolution_),n=this.minResolution_,s=Math.log(e/n)/Math.log(t);return function(r){return e/Math.pow(t,r*s)}}getRotation(){return this.get(q.ROTATION)}getValueForResolutionFunction(t){const e=Math.log(t||2),n=this.getConstrainedResolution(this.maxResolution_),s=this.minResolution_,r=Math.log(n/s)/e;return function(o){return Math.log(n/o)/e/r}}getViewportSizeMinusPadding_(t){let e=this.getViewportSize_(t);const n=this.padding_;return n&&(e=[e[0]-n[1]-n[3],e[1]-n[0]-n[2]]),e}getState(){const t=this.getProjection(),e=this.getResolution(),n=this.getRotation();let s=this.getCenterInternal();const r=this.padding_;if(r){const o=this.getViewportSizeMinusPadding_();s=je(s,this.getViewportSize_(),[o[0]/2+r[3],o[1]/2+r[0]],e,n)}return{center:s.slice(0),projection:t!==void 0?t:null,resolution:e,nextCenter:this.nextCenter_,nextResolution:this.nextResolution_,nextRotation:this.nextRotation_,rotation:n,zoom:this.getZoom()}}getViewStateAndExtent(){return{viewState:this.getState(),extent:this.calculateExtent()}}getZoom(){let t;const e=this.getResolution();return e!==void 0&&(t=this.getZoomForResolution(e)),t}getZoomForResolution(t){let e=this.minZoom_||0,n,s;if(this.resolutions_){const r=qe(this.resolutions_,t,1);e=r,n=this.resolutions_[r],r==this.resolutions_.length-1?s=2:s=n/this.resolutions_[r+1]}else n=this.maxResolution_,s=this.zoomFactor_;return e+Math.log(n/t)/Math.log(s)}getResolutionForZoom(t){if(this.resolutions_?.length){if(this.resolutions_.length===1)return this.resolutions_[0];const e=F(Math.floor(t),0,this.resolutions_.length-2),n=this.resolutions_[e]/this.resolutions_[e+1];return this.resolutions_[e]/Math.pow(n,F(t-e,0,1))}return this.maxResolution_/Math.pow(this.zoomFactor_,t-this.minZoom_)}fit(t,e){let n;if(W(Array.isArray(t)||typeof t.getSimplifiedGeometry=="function","Invalid extent or geometry provided as `geometry`"),Array.isArray(t)){W(!xe(t),"Cannot fit empty extent provided as `geometry`");const s=Rt(t,this.getProjection());n=ei(s)}else if(t.getType()==="Circle"){const s=Rt(t.getExtent(),this.getProjection());n=ei(s),n.rotate(this.getRotation(),Et(s))}else n=t;this.fitInternal(n,e)}rotatedExtentForGeometry(t){const e=this.getRotation(),n=Math.cos(e),s=Math.sin(-e),r=t.getFlatCoordinates(),o=t.getStride();let a=1/0,h=1/0,u=-1/0,l=-1/0;for(let c=0,d=r.length;c<d;c+=o){const f=r[c]*n-r[c+1]*s,g=r[c]*s+r[c+1]*n;a=Math.min(a,f),h=Math.min(h,g),u=Math.max(u,f),l=Math.max(l,g)}return[a,h,u,l]}fitInternal(t,e){e=e||{};let n=e.size;n||(n=this.getViewportSizeMinusPadding_());const s=e.padding!==void 0?e.padding:[0,0,0,0],r=e.nearest!==void 0?e.nearest:!1;let o;e.minResolution!==void 0?o=e.minResolution:e.maxZoom!==void 0?o=this.getResolutionForZoom(e.maxZoom):o=0;const a=this.rotatedExtentForGeometry(t);let h=this.getResolutionForExtentInternal(a,[n[0]-s[1]-s[3],n[1]-s[0]-s[2]]);h=isNaN(h)?o:Math.max(h,o),h=this.getConstrainedResolution(h,r?0:1);const u=this.getRotation(),l=Math.sin(u),c=Math.cos(u),d=Et(a);d[0]+=(s[1]-s[3])/2*h,d[1]+=(s[0]-s[2])/2*h;const f=d[0]*c-d[1]*l,g=d[1]*c+d[0]*l,_=this.getConstrainedCenter([f,g],h),m=e.callback?e.callback:ae;e.duration!==void 0?this.animateInternal({resolution:h,center:_,duration:e.duration,easing:e.easing},m):(this.targetResolution_=h,this.targetCenter_=_,this.applyTargetState_(!1,!0),ie(m,!0))}centerOn(t,e,n){this.centerOnInternal(ut(t,this.getProjection()),e,n)}centerOnInternal(t,e,n){this.setCenterInternal(je(t,e,n,this.getResolution(),this.getRotation()))}calculateCenterShift(t,e,n,s){let r;const o=this.padding_;if(o&&t){const a=this.getViewportSizeMinusPadding_(-n),h=je(t,s,[a[0]/2+o[3],a[1]/2+o[0]],e,n);r=[t[0]-h[0],t[1]-h[1]]}return r}isDef(){return!!this.getCenterInternal()&&this.getResolution()!==void 0}adjustCenter(t){const e=Pn(this.targetCenter_,this.getProjection());this.setCenter([e[0]+t[0],e[1]+t[1]])}adjustCenterInternal(t){const e=this.targetCenter_;this.setCenterInternal([e[0]+t[0],e[1]+t[1]])}adjustResolution(t,e){e=e&&ut(e,this.getProjection()),this.adjustResolutionInternal(t,e)}adjustResolutionInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.getViewportSize_(this.getRotation()),r=this.constraints_.resolution(this.targetResolution_*t,0,s,n);e&&(this.targetCenter_=this.calculateCenterZoom(r,e)),this.targetResolution_*=t,this.applyTargetState_()}adjustZoom(t,e){this.adjustResolution(Math.pow(this.zoomFactor_,-t),e)}adjustRotation(t,e){e&&(e=ut(e,this.getProjection())),this.adjustRotationInternal(t,e)}adjustRotationInternal(t,e){const n=this.getAnimating()||this.getInteracting(),s=this.constraints_.rotation(this.targetRotation_+t,n);e&&(this.targetCenter_=this.calculateCenterRotate(s,e)),this.targetRotation_+=t,this.applyTargetState_()}setCenter(t){this.setCenterInternal(t&&ut(t,this.getProjection()))}setCenterInternal(t){this.targetCenter_=t,this.applyTargetState_()}setHint(t,e){return this.hints_[t]+=e,this.changed(),this.hints_[t]}setResolution(t){this.targetResolution_=t,this.applyTargetState_()}setRotation(t){this.targetRotation_=t,this.applyTargetState_()}setZoom(t){this.setResolution(this.getResolutionForZoom(t))}applyTargetState_(t,e){const n=this.getAnimating()||this.getInteracting()||e,s=this.constraints_.rotation(this.targetRotation_,n),r=this.getViewportSize_(s),o=this.constraints_.resolution(this.targetResolution_,0,r,n),a=this.constraints_.center(this.targetCenter_,o,r,n,this.calculateCenterShift(this.targetCenter_,o,s,r));this.get(q.ROTATION)!==s&&this.set(q.ROTATION,s),this.get(q.RESOLUTION)!==o&&(this.set(q.RESOLUTION,o),this.set("zoom",this.getZoom(),!0)),(!a||!this.get(q.CENTER)||!kt(this.get(q.CENTER),a))&&this.set(q.CENTER,a),this.getAnimating()&&!t&&this.cancelAnimations(),this.cancelAnchor_=void 0}resolveConstraints(t,e,n){t=t!==void 0?t:200;const s=e||0,r=this.constraints_.rotation(this.targetRotation_),o=this.getViewportSize_(r),a=this.constraints_.resolution(this.targetResolution_,s,o),h=this.constraints_.center(this.targetCenter_,a,o,!1,this.calculateCenterShift(this.targetCenter_,a,r,o));if(t===0&&!this.cancelAnchor_){this.targetResolution_=a,this.targetRotation_=r,this.targetCenter_=h,this.applyTargetState_();return}n=n||(t===0?this.cancelAnchor_:void 0),this.cancelAnchor_=void 0,(this.getResolution()!==a||this.getRotation()!==r||!this.getCenterInternal()||!kt(this.getCenterInternal(),h))&&(this.getAnimating()&&this.cancelAnimations(),this.animateInternal({rotation:r,center:h,resolution:a,duration:t,easing:hi,anchor:n}))}beginInteraction(){this.resolveConstraints(0),this.setHint(ct.INTERACTING,1)}endInteraction(t,e,n){n=n&&ut(n,this.getProjection()),this.endInteractionInternal(t,e,n)}endInteractionInternal(t,e,n){this.getInteracting()&&(this.setHint(ct.INTERACTING,-1),this.resolveConstraints(t,e,n))}getConstrainedCenter(t,e){const n=this.getViewportSize_(this.getRotation());return this.constraints_.center(t,e||this.getResolution(),n)}getConstrainedZoom(t,e){const n=this.getResolutionForZoom(t);return this.getZoomForResolution(this.getConstrainedResolution(n,e))}getConstrainedResolution(t,e){e=e||0;const n=this.getViewportSize_(this.getRotation());return this.constraints_.resolution(t,e,n)}}function ie(i,t){setTimeout(function(){i(t)},0)}function Vr(i){if(i.extent!==void 0){const e=i.smoothExtentConstraint!==void 0?i.smoothExtentConstraint:!0;return jn(i.extent,i.constrainOnlyCenter,e)}const t=$e(i.projection,"EPSG:3857");if(i.multiWorld!==!0&&t.isGlobal()){const e=t.getExtent().slice();return e[0]=-1/0,e[2]=1/0,jn(e,!1,!1)}return gr}function qr(i){let t,e,n,s=i.minZoom!==void 0?i.minZoom:Xe,r=i.maxZoom!==void 0?i.maxZoom:28;const o=i.zoomFactor!==void 0?i.zoomFactor:2,a=i.multiWorld!==void 0?i.multiWorld:!1,h=i.smoothResolutionConstraint!==void 0?i.smoothResolutionConstraint:!0,u=i.showFullExtent!==void 0?i.showFullExtent:!1,l=$e(i.projection,"EPSG:3857"),c=l.getExtent();let d=i.constrainOnlyCenter,f=i.extent;if(!a&&!f&&l.isGlobal()&&(d=!1,f=c),i.resolutions!==void 0){const g=i.resolutions;e=g[s],n=g[r]!==void 0?g[r]:g[g.length-1],i.constrainResolution?t=jr(g,h,!d&&f,u):t=ni(e,n,h,!d&&f,u)}else{const g=(c?Math.max(A(c),U(c)):360*cn.degrees/l.getMetersPerUnit())/kr/Math.pow(2,Xe),_=g/Math.pow(2,28-Xe);e=i.maxResolution,e!==void 0?s=0:e=g/Math.pow(o,s),n=i.minResolution,n===void 0&&(i.maxZoom!==void 0?i.maxResolution!==void 0?n=e/Math.pow(o,r):n=g/Math.pow(o,r):n=_),r=s+Math.floor(Math.log(e/n)/Math.log(o)),n=e/Math.pow(o,r-s),i.constrainResolution?t=Yr(o,e,n,h,!d&&f,u):t=ni(e,n,h,!d&&f,u)}return{constraint:t,maxResolution:e,minResolution:n,minZoom:s,zoomFactor:o}}function Hr(i){if(i.enableRotation===void 0||i.enableRotation){const t=i.constrainRotation;return t===void 0||t===!0?Kr():t===!1?ii:typeof t=="number"?Wr(t):ii}return zr}function Br(i){return!(i.sourceCenter&&i.targetCenter&&!kt(i.sourceCenter,i.targetCenter)||i.sourceResolution!==i.targetResolution||i.sourceRotation!==i.targetRotation)}function je(i,t,e,n,s){const r=Math.cos(-s);let o=Math.sin(-s),a=i[0]*r-i[1]*o,h=i[1]*r+i[0]*o;a+=(t[0]/2-e[0])*n,h+=(e[1]-t[1]/2)*n,o=-o;const u=a*r-h*o,l=h*r+a*o;return[u,l]}var si=Ur,M={OPACITY:"opacity",VISIBLE:"visible",EXTENT:"extent",Z_INDEX:"zIndex",MAX_RESOLUTION:"maxResolution",MIN_RESOLUTION:"minResolution",MAX_ZOOM:"maxZoom",MIN_ZOOM:"minZoom",SOURCE:"source",MAP:"map"};class Qr extends Fe{constructor(t){super(),this.on,this.once,this.un,this.background_=t.background;const e=Object.assign({},t);typeof t.properties=="object"&&(delete e.properties,Object.assign(e,t.properties)),e[M.OPACITY]=t.opacity!==void 0?t.opacity:1,W(typeof e[M.OPACITY]=="number","Layer opacity must be a number"),e[M.VISIBLE]=t.visible!==void 0?t.visible:!0,e[M.Z_INDEX]=t.zIndex,e[M.MAX_RESOLUTION]=t.maxResolution!==void 0?t.maxResolution:1/0,e[M.MIN_RESOLUTION]=t.minResolution!==void 0?t.minResolution:0,e[M.MIN_ZOOM]=t.minZoom!==void 0?t.minZoom:-1/0,e[M.MAX_ZOOM]=t.maxZoom!==void 0?t.maxZoom:1/0,this.className_=e.className!==void 0?e.className:"ol-layer",delete e.className,this.setProperties(e),this.state_=null}getBackground(){return this.background_}getClassName(){return this.className_}getLayerState(t){const e=this.state_||{layer:this,managed:t===void 0?!0:t},n=this.getZIndex();return e.opacity=F(Math.round(this.getOpacity()*100)/100,0,1),e.visible=this.getVisible(),e.extent=this.getExtent(),e.zIndex=n===void 0&&!e.managed?1/0:n,e.maxResolution=this.getMaxResolution(),e.minResolution=Math.max(this.getMinResolution(),0),e.minZoom=this.getMinZoom(),e.maxZoom=this.getMaxZoom(),this.state_=e,e}getLayersArray(t){return O()}getLayerStatesArray(t){return O()}getExtent(){return this.get(M.EXTENT)}getMaxResolution(){return this.get(M.MAX_RESOLUTION)}getMinResolution(){return this.get(M.MIN_RESOLUTION)}getMinZoom(){return this.get(M.MIN_ZOOM)}getMaxZoom(){return this.get(M.MAX_ZOOM)}getOpacity(){return this.get(M.OPACITY)}getSourceState(){return O()}getVisible(){return this.get(M.VISIBLE)}getZIndex(){return this.get(M.Z_INDEX)}setBackground(t){this.background_=t,this.changed()}setExtent(t){this.set(M.EXTENT,t)}setMaxResolution(t){this.set(M.MAX_RESOLUTION,t)}setMinResolution(t){this.set(M.MIN_RESOLUTION,t)}setMaxZoom(t){this.set(M.MAX_ZOOM,t)}setMinZoom(t){this.set(M.MIN_ZOOM,t)}setOpacity(t){W(typeof t=="number","Layer opacity must be a number"),this.set(M.OPACITY,t)}setVisible(t){this.set(M.VISIBLE,t)}setZIndex(t){this.set(M.Z_INDEX,t)}disposeInternal(){this.state_&&(this.state_.layer=null,this.state_=null),super.disposeInternal()}}var Jr=Qr;class to extends Jr{constructor(t){const e=Object.assign({},t);delete e.source,super(e),this.on,this.once,this.un,this.mapPrecomposeKey_=null,this.mapRenderKey_=null,this.sourceChangeKey_=null,this.renderer_=null,this.sourceReady_=!1,this.rendered=!1,t.render&&(this.render=t.render),t.map&&this.setMap(t.map),this.addChangeListener(M.SOURCE,this.handleSourcePropertyChange_);const n=t.source?t.source:null;this.setSource(n)}getLayersArray(t){return t=t||[],t.push(this),t}getLayerStatesArray(t){return t=t||[],t.push(this.getLayerState()),t}getSource(){return this.get(M.SOURCE)||null}getRenderSource(){return this.getSource()}getSourceState(){const t=this.getSource();return t?t.getState():"undefined"}handleSourceChange_(){this.changed(),!(this.sourceReady_||this.getSource().getState()!=="ready")&&(this.sourceReady_=!0,this.dispatchEvent("sourceready"))}handleSourcePropertyChange_(){this.sourceChangeKey_&&(ht(this.sourceChangeKey_),this.sourceChangeKey_=null),this.sourceReady_=!1;const t=this.getSource();t&&(this.sourceChangeKey_=ft(t,ot.CHANGE,this.handleSourceChange_,this),t.getState()==="ready"&&(this.sourceReady_=!0,setTimeout(()=>{this.dispatchEvent("sourceready")},0)),this.clearRenderer()),this.changed()}getFeatures(t){return this.renderer_?this.renderer_.getFeatures(t):Promise.resolve([])}getData(t){return!this.renderer_||!this.rendered?null:this.renderer_.getData(t)}isVisible(t){let e;const n=this.getMapInternal();!t&&n&&(t=n.getView()),t instanceof si?e={viewState:t.getState(),extent:t.calculateExtent()}:e=t,!e.layerStatesArray&&n&&(e.layerStatesArray=n.getLayerGroup().getLayerStatesArray());let s;if(e.layerStatesArray){if(s=e.layerStatesArray.find(o=>o.layer===this),!s)return!1}else s=this.getLayerState();const r=this.getExtent();return eo(s,e.viewState)&&(!r||Nt(r,e.extent))}getAttributions(t){if(!this.isVisible(t))return[];const e=this.getSource()?.getAttributions();if(!e)return[];const n=t instanceof si?t.getViewStateAndExtent():t;let s=e(n);return Array.isArray(s)||(s=[s]),s}render(t,e){const n=this.getRenderer();return n.prepareFrame(t)?(this.rendered=!0,n.renderFrame(t,e)):null}unrender(){this.rendered=!1}getDeclutter(){}renderDeclutter(t,e){}renderDeferred(t){const e=this.getRenderer();e&&e.renderDeferred(t)}setMapInternal(t){t||this.unrender(),this.set(M.MAP,t)}getMapInternal(){return this.get(M.MAP)}setMap(t){this.mapPrecomposeKey_&&(ht(this.mapPrecomposeKey_),this.mapPrecomposeKey_=null),t||this.changed(),this.mapRenderKey_&&(ht(this.mapRenderKey_),this.mapRenderKey_=null),t&&(this.mapPrecomposeKey_=ft(t,Xt.PRECOMPOSE,this.handlePrecompose_,this),this.mapRenderKey_=ft(this,ot.CHANGE,t.render,t),this.changed())}handlePrecompose_(t){const e=t.frameState.layerStatesArray,n=this.getLayerState(!1);W(!e.some(s=>s.layer===n.layer),"A layer can only be added to the map once. Use either `layer.setMap()` or `map.addLayer()`, not both."),e.push(n)}setSource(t){this.set(M.SOURCE,t)}getRenderer(){return this.renderer_||(this.renderer_=this.createRenderer()),this.renderer_}hasRenderer(){return!!this.renderer_}createRenderer(){return null}clearRenderer(){this.renderer_&&(this.renderer_.dispose(),delete this.renderer_)}disposeInternal(){this.clearRenderer(),this.setSource(null),super.disposeInternal()}}function eo(i,t){if(!i.visible)return!1;const e=t.resolution;if(e<i.minResolution||e>=i.maxResolution)return!1;const n=t.zoom;return n>i.minZoom&&n<=i.maxZoom}var no=to,se={PRELOAD:"preload",USE_INTERIM_TILES_ON_ERROR:"useInterimTilesOnError"};let io=class extends no{constructor(t){t=t||{};const e=Object.assign({},t),n=t.cacheSize;delete t.cacheSize,delete e.preload,delete e.useInterimTilesOnError,super(e),this.on,this.once,this.un,this.cacheSize_=n,this.setPreload(t.preload!==void 0?t.preload:0),this.setUseInterimTilesOnError(t.useInterimTilesOnError!==void 0?t.useInterimTilesOnError:!0)}getCacheSize(){return this.cacheSize_}getPreload(){return this.get(se.PRELOAD)}setPreload(t){this.set(se.PRELOAD,t)}getUseInterimTilesOnError(){return this.get(se.USE_INTERIM_TILES_ON_ERROR)}setUseInterimTilesOnError(t){this.set(se.USE_INTERIM_TILES_ON_ERROR,t)}getData(t){return super.getData(t)}};var so=io;class ro extends so{constructor(t){super(t)}createRenderer(){return new ur(this,{cacheSize:this.getCacheSize()})}}var oo=ro;export{oo as default};
